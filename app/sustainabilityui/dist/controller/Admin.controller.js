sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox","sap/ui/core/Fragment","sap/m/MessageToast","sap/ui/model/FilterOperator","sap/ui/model/Filter","sap/ui/core/syncStyleClass","sap/m/Token"],function(e,t,s,a,i,r,o){"use strict";return e.extend("com.techm.sustainabilityui.controller.Admin",{onInit:function(){let e=sap.ui.core.UIComponent.getRouterFor(this);let t=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().setModel(t);this.UserInputUnit="";this.ExpectedOutputUnit="";this.EFSelected="ENERGY";this.KPIListTypeSelected="Environment";this.SDG="";this.Scope="";this.CalculationLogic="";this.Standard="";this.Measure="";this.Template="";this.RENON="";this.EFStandard="";this.KPI_EF="";let s=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().setModel(s,"viewModel");this.ConversionTypeSelected="UoM Conversions";this.UoMTypeSelected="Measure Type";this.EFTypeSelected="DEFRA";this.PrefixTypesSelected="Prefix Types";this._mViewSettingsDialogs={};var a={data:[{name:"GRI",value:"GRI"},{name:"SASB",value:"SASB"}]};var i=new sap.ui.model.json.JSONModel(a);this.getView().setModel(i,"StdsModel");var r={data:[{name:"Yes",value:"Yes"},{name:"No",value:"No"}]};var o=new sap.ui.model.json.JSONModel(r);this.getView().setModel(o,"BioGen");var l=new sap.ui.model.json.JSONModel;this.getView().setModel(l,"NodesModel");this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getTarget("Admin").attachDisplay(jQuery.proxy(this.handleRouteMatched,this))},handleRouteMatched:function(e){this.GlobalIndustryModel=sap.ui.getCore().getModel("GlobalIndustryModel");this.initRichTextEditor(true);var t=this.GlobalIndustryModel.getData().Industry;if(t==="IT"){this.UOMSelected="Area";this.UOMConversionMeasure="Area";this.KPITypeSelected="NETWORK TRAFFIC"}else if(t==="Telecom"){this.UOMSelected="Data";this.UOMConversionMeasure="Data";this.KPITypeSelected="NETWORK TRAFFIC"}this.PrefixSelected="Employee Category";this.total=0;this.valArray=[];this.socialPrefix="";this.callODataService()},onAfterRendering:function(){this.getView().byId("shortLongColn").setVisible(false);this.getView().byId("classColn").setVisible(false)},addNewButtonPressHandler:function(e){},onPressBack:function(e){this.getOwnerComponent().getRouter().navTo("Launchpad",{},true)},handleSelectionFinish_StdsLogic:function(e){var t=e.getParameter("selectedItems");var s="";for(var a=0;a<t.length;a++){s+=t[a].getText();if(a!=t.length-1){s+=","}}},onValueHelpRequest:function(e){var t=e.getSource().getValue(),s=this.getView();if(!this._pValueHelpDialog){this._pValueHelpDialog=sap.ui.core.Fragment.load({id:s.getId(),name:"com.techm.sustainabilityui.fragment.ValueHelpDialog",controller:this}).then(function(e){s.addDependent(e);return e})}this._pValueHelpDialog.then(function(e){var s={Product:[{SDGimgUrl:"./images/SDG/E-WEB-Goal-01.png",Name:"SDG 1 : No Poverty"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-02.png",Name:"SDG 2 : Zero Hunger"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-03.png",Name:"SDG 3 : Good Health and Well-being"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-04.png",Name:"SDG 4 : Quality Education"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-05.png",Name:"SDG 5 : Gender Equality"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-06.png",Name:"SDG 6 : Clean Water and Sanitation"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-07.png",Name:"SDG 7 : Affordable and Clean Energy"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-08.png",Name:"SDG 8 : Decent Work and Economic Growth"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-09.png",Name:"SDG 9 : Industry Innovation and Infrastructure"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-10.png",Name:"SDG 10 : Reduced Inequalities"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-11.png",Name:"SDG 11 : Sustainable Cities and Communities"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-12.png",Name:"SDG 12 : Responsible Consumption and Production"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-13.png",Name:"SDG 13 : Climate Action"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-14.png",Name:"SDG 14 : Life Below Water"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-15.png",Name:"SDG 15 : Life On Land"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-16.png",Name:"SDG 16 : Peace Justice and Strong Institutions"},{SDGimgUrl:"./images/SDG/E-WEB-Goal-17.png",Name:"SDG 17 : Partnership for The Goals"}]};var a=new sap.ui.model.json.JSONModel(s);sap.ui.getCore().setModel(a);e.setModel(a);e.open(t)})},onValueHelpDialogSearch:function(e){var t=e.getParameter("value");var s=new sap.ui.model.Filter("Name",sap.ui.model.FilterOperator.Contains,t);e.getSource().getBinding("items").filter([s])},onValueHelpDialogClose:function(e){var t=e.getParameter("selectedItems");var s=this.getView().byId("KPIListTbl").getItems();var a=this.getView().byId("KPIListTbl").getItems().length-1;var i=s[a].mAggregations.cells[17].getItems()[1];var r=this.getView().byId("KPIListTbl").getModel("KPIModel");var o="";for(var l=0;l<r.getData().results.length;l++){if(r.getData().results[l].isNewRow){console.log("newRow");if(t&&t.length>0){t.forEach(function(e){i.addToken(new sap.m.Token({text:e.getTitle()}))})}}}},onTokenUpdateSDG:function(e){console.log("onTokenUpdateSDG")},onSuggestionItemSelected:function(e){var t=e.getParameter("selectedItem");var s=t?t.getKey():"";this.byId("selectedKeyIndicator").setText(s)},onPressEdit:function(e){var t=this;var s=t.getView().byId("myTabContainer").getSelectedItem();s=s.substring(s.lastIndexOf("-")+1);var a=t.getView().byId("myTabContainer1").getSelectedItem();a=a.substring(a.lastIndexOf("-")+1);var i=t.getView().byId("myTabContainer2").getSelectedItem();if(s==="KPI_List"){if(this.KPIListTypeSelected==="Environment"){var r="KPIListTbl";var o="KPIList";var l=this.getView().byId(r).getModel("KPIModel")}else if(this.KPIListTypeSelected==="Social"){var r="SocialKPIList";var o="KPIList_Social_Ports";var l=this.getView().byId(r).getModel()}var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var u=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var d=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var m=n[g].mAggregations.cells[2].mAggregations.items[0].mProperties.text;for(var c=0;c<l.getData().results.length;c++){if(u===l.getData().results[c].Type&&d===l.getData().results[c].SubType&&m===l.getData().results[c].KPI){l.getData().results[c].isEditableRow=true;break}else continue}}l.refresh(true)}else if(s==="UoM"){var p=this.UOMSelected;var r="uomVolumeTbl";var o="UOM";var f=this.getView().byId(r).getModel();var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var v=""+p;var h=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;for(var c=0;c<f.getData().results.length;c++){if(h===f.getData().results[c].Abbreviation){f.getData().results[c].isEditableRow=true;break}else continue}}f.refresh(true)}else if(s==="Factors"){i=i.substring(i.lastIndexOf("-")+1);if(i==="UoM_Conversions"){if(this.ConversionTypeSelected==="UoM Conversions"){console.log("1:"+this.UOMConversionMeasure);var y=this.UOMConversionMeasure;var r="uomConVolTbl";var o="UoMConversions";var b=this.getView().byId(r).getModel("UOMConvModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var M=""+y;var I=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var w=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;for(var c=0;c<b.getData().results.length;c++){if(M===b.getData().results[c].Measure&&I===b.getData().results[c].UserInputUnit&&w===b.getData().results[c].ExpectedOutputUnit){b.getData().results[c].isEditableRow=true;break}else continue}}b.refresh(true)}else if(this.ConversionTypeSelected==="Measure Conversions"){var S=this.UOMConversionMeasure;var r="measureConvsTbl";var o="Measure_Module";var b=this.getView().byId(r).getModel("measureConvsModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var M=""+S;var I=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var w=n[g].mAggregations.cells[2].mAggregations.items[0].mProperties.text;for(var c=0;c<b.getData().results.length;c++){if(M===b.getData().results[c].InputMeasureType&&I===b.getData().results[c].InputUom&&w===b.getData().results[c].OutputUoM){b.getData().results[c].isEditableRow=true;break}else continue}}b.refresh(true)}}else if(i==="Energy_Factors"){var r="energyConvTbl";var P=this.getView().byId(r).getModel("EnergyConvModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var T=""+this.KPITypeSelected;var D=t.getView().byId("Sub_Type").getSelectedKey();var m=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var I=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;for(var c=0;c<P.getData().results.length;c++){if(m===P.getData().results[c].KPI&&I===P.getData().results[c].UserInputUnit){P.getData().results[c].isEditableRow=true;break}else continue}}P.refresh(true)}else if(i==="Emission_Factors"){console.log("Emission Factors");var r="EmissionFactorsTbl";var V=this.getView().byId(r).getModel("EmissionFactorsModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var m=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var E=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var C=n[g].mAggregations.cells[4].mAggregations.items[0].mProperties.text;var A=n[g].mAggregations.cells[5].mAggregations.items[0].mProperties.text;for(var c=0;c<V.getData().results.length;c++){if(m===V.getData().results[c].KPI&&E===V.getData().results[c].Standard&&C===V.getData().results[c].Shortlong&&A===V.getData().results[c].class){V.getData().results[c].isEditableRow=true;break}else continue}}V.refresh(true)}}else if(s==="Year"){var r="generalYearTbl";var x=this.getView().byId(r).getModel("yearModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var O=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var F=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var _=n[g].mAggregations.cells[2].mAggregations.items[0].mProperties.text;var U=n[g].mAggregations.cells[3].mProperties.text;for(var c=0;c<x.getData().results.length;c++){if(F===x.getData().results[c].StartDate&&_===x.getData().results[c].EndDate){x.getData().results[c].isEditableRow=true;break}else continue}}x.refresh(true)}},onPressReset:function(e){var t=this;var s=t.getView().byId("myTabContainer").getSelectedItem();s=s.substring(s.lastIndexOf("-")+1);var a=t.getView().byId("myTabContainer1").getSelectedItem();a=a.substring(a.lastIndexOf("-")+1);var i=t.getView().byId("myTabContainer2").getSelectedItem();if(s==="KPI_List"){if(this.KPIListTypeSelected==="Environment"){var r="KPIListTbl";var o="KPIList";var l=this.getView().byId(r).getModel("KPIModel")}else if(this.KPIListTypeSelected==="Social"){var r="SocialKPIList";var o="KPIList_Social_Ports";var l=this.getView().byId(r).getModel()}var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var u=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var d=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var m=n[g].mAggregations.cells[2].mAggregations.items[0].mProperties.text;for(var c=0;c<l.getData().results.length;c++){if(u===l.getData().results[c].Type&&d===l.getData().results[c].SubType&&m===l.getData().results[c].KPI){l.getData().results[c].isEditableRow=false;break}else continue}}l.refresh(true)}else if(s==="UoM"){console.log("UoM");var p=this.UOMSelected;var r="uomVolumeTbl";var o="UOM";var f=this.getView().byId(r).getModel();var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var v=""+p;var h=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;for(var c=0;c<f.getData().results.length;c++){if(h===f.getData().results[c].Abbreviation){f.getData().results[c].isEditableRow=false;break}else continue}}f.refresh(true)}else if(s==="Factors"){i=i.substring(i.lastIndexOf("-")+1);if(i==="UoM_Conversions"){if(this.ConversionTypeSelected==="UoM Conversions"){var y=this.UOMConversionMeasure;var r="uomConVolTbl";var o="UoMConversions";var b=this.getView().byId(r).getModel("UOMConvModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var M=""+y;var I=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var w=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;for(var c=0;c<b.getData().results.length;c++){if(M===b.getData().results[c].Measure&&I===b.getData().results[c].UserInputUnit&&w===b.getData().results[c].ExpectedOutputUnit){b.getData().results[c].isEditableRow=false;break}else continue}}b.refresh(true)}else if(this.ConversionTypeSelected==="Measure Conversions"){var S=this.UOMConversionMeasure;var r="measureConvsTbl";var o="Measure_Module";var b=this.getView().byId(r).getModel("measureConvsModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var M=""+S;var I=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var w=n[g].mAggregations.cells[2].mAggregations.items[0].mProperties.text;for(var c=0;c<b.getData().results.length;c++){if(M===b.getData().results[c].InputMeasureType&&I===b.getData().results[c].InputUom&&w===b.getData().results[c].OutputUoM){b.getData().results[c].isEditableRow=false;break}else continue}}b.refresh(true)}}else if(i==="Energy_Factors"){var r="energyConvTbl";var P=this.getView().byId(r).getModel("EnergyConvModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var T=""+this.KPITypeSelected;var D=t.getView().byId("Sub_Type").getSelectedKey();var m=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var I=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;for(var c=0;c<P.getData().results.length;c++){if(m===P.getData().results[c].KPI&&I===P.getData().results[c].UserInputUnit){P.getData().results[c].isEditableRow=false;break}else continue}}P.refresh(true)}else if(i==="Emission_Factors"){var r="EmissionFactorsTbl";var V=this.getView().byId(r).getModel("EmissionFactorsModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var m=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var E=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var C=n[g].mAggregations.cells[4].mAggregations.items[0].mProperties.text;var A=n[g].mAggregations.cells[5].mAggregations.items[0].mProperties.text;for(var c=0;c<V.getData().results.length;c++){if(m===V.getData().results[c].KPI&&E===V.getData().results[c].Standard&&C===V.getData().results[c].Shortlong&&A===V.getData().results[c].class){V.getData().results[c].isEditableRow=false;break}else continue}}V.refresh(true)}}else if(s==="Year"){var r="generalYearTbl";var x=this.getView().byId(r).getModel("yearModel");var n=this.getView().byId(r).getSelectedItems();for(var g=0;g<n.length;g++){var O=n[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var F=n[g].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var _=n[g].mAggregations.cells[2].mAggregations.items[0].mProperties.text;var U=n[g].mAggregations.cells[3].mProperties.text;for(var c=0;c<x.getData().results.length;c++){if(F===x.getData().results[c].StartDate&&_===x.getData().results[c].EndDate){x.getData().results[c].isEditableRow=false;break}else continue}}x.refresh(true)}},onPressSubmitMsg:function(e){sap.m.MessageBox.show("Do you want to submit the record.",{icon:t.Icon.WARNING,title:"Warning",actions:[t.Action.YES,t.Action.NO],emphasizedAction:t.Action.YES,onClose:function(t){if(t=="NO"){return false}if(t=="Yes"){this.onPressSubmit(e)}}})},onPressSubmit:function(e){var s=this;var a=s.getView().byId("myTabContainer").getSelectedItem();a=a.substring(a.lastIndexOf("-")+1);console.log("selectedTab:"+a);var i=s.getView().byId("myTabContainer1").getSelectedItem();i=i.substring(i.lastIndexOf("-")+1);console.log("selectedTab:"+i);var r=s.getView().byId("myTabContainer2").getSelectedItem();if(a==="UoM"){if(this.UoMTypeSelected==="Measure Type"){var o="generalTbl";var l="Constants_Telecom";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh()}else console.log("No Record present for Database Operation")}else if(this.UoMTypeSelected==="UoM Values"){var o="uomVolumeTbl";var l="UOM";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}}else if(a==="Factors"){r=r.substring(r.lastIndexOf("-")+1);console.log("selectedTab2:"+r);if(r==="UoM_Conversions"){if(this.ConversionTypeSelected==="UoM Conversions"){var n="",g;var o="uomConVolTbl";var l="UoMConversions";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}else if(this.ConversionTypeSelected==="Measure Conversions"){var o="measureConvsTbl";var l="Measure_Module";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}}else if(r==="Energy_Factors"){var o="energyConvTbl";var l="EnergyCnversions";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}else if(r==="Emission_Factors"){var o="EmissionFactorsTbl";var l="EmissionFactors";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}}else if(a==="KPI_List"){if(this.KPIListTypeSelected==="Environment"){var o="KPIListTbl";var l="KPIList"}else if(this.KPIListTypeSelected==="Social"){var o="SocialKPIList";var l="KPIList_Social_Ports"}this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}else if(a==="General"){if(this.PrefixTypesSelected==="Prefix Types"){var o="prefixTypesTbl";var l="Prefix_Types";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh()}else console.log("No Record present for Database Operation")}else if(this.PrefixTypesSelected==="Prefix Values"){var o="prefixValuesTbl";var l="Prefix_Values";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}}else if(a==="CorporateStructure"){if(i==="Division"){var o="tblDivision";var l="Division";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchModel.setUseBatch(true);this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh()}else console.log("No Record present for Database Operation")}else if(i==="Location"){var o="tblLocation";var l="Location";this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh()}else console.log("No Record present for Database Operation")}}else if(a==="Year"){var o="generalYearTbl";var l="Year_Module";var u=this.getView().byId(o).getModel("yearModel");for(var d=0;d<u.getData().results.length;d++){if(u.getData().results[d].isNewRow){var m=new Date(u.oData.results[d].EndDate).getMonth()-new Date(u.oData.results[d].StartDate).getMonth()+12*(new Date(u.oData.results[d].EndDate).getFullYear()-new Date(u.oData.results[d].StartDate).getFullYear())}}console.log("count:"+m);if(m>12){t.alert("Month count should not be more than 12")}else{this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];this.onCreateEntry_Table(o,l);this.onUpdateEntry_Table(o,l);this.batchModel.submitChanges({success:function(e,t){},error:function(e){}})}}},onCreate_Social:function(){var e=this;var t;var s=e.getView().byId("SocialKPIList").getItems();var a=e.getView().byId("SocialKPIList").getItems().length-1;t=e.getView().byId("SocialKPIList").getModel();for(var i=0;i<t.getData().results.length;i++){if(t.getData().results[i].isNewRow){sap.m.MessageToast.show("prefix:"+s[a].mAggregations.cells[5].mAggregations.items[1].mProperties.value)}}},onCreateEntry_Table:function(e,s){var a=this;var i;var r=a.getView().byId(e).getItems();var o=a.getView().byId(e).getItems().length-1;if(e==="KPIListTbl"){i=this.getView().byId(e).getModel("KPIModel")}else if(e==="EmissionFactorsTbl"){i=this.getView().byId(e).getModel("EmissionFactorsModel")}else if(e==="uomConVolTbl"){i=this.getView().byId(e).getModel("UOMConvModel")}else if(e==="energyConvTbl"){i=this.getView().byId(e).getModel("EnergyConvModel")}else if(e==="generalTbl"){i=this.getView().byId(e).getModel("generalModel")}else if(e==="tblDivision"){i=this.getView().byId(e).getModel("divisionModel")}else if(e==="tblLocation"){i=this.getView().byId(e).getModel("locationModel")}else if(e==="generalYearTbl"){i=this.getView().byId(e).getModel("yearModel")}else if(e==="measureConvsTbl"){i=this.getView().byId(e).getModel("measureConvsModel")}else if(e==="prefixTypesTbl"){i=this.getView().byId(e).getModel("PrefixTypesModel")}else if(e==="prefixValuesTbl"){i=this.getView().byId(e).getModel("PrefixValuesModel")}else{i=a.getView().byId(e).getModel()}for(var l=0;l<i.getData().results.length;l++){if(i.getData().results[l].isNewRow){if(e==="KPIListTbl"){var n=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var g={Industry:""+n,Type:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value,SubType:r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.value,KPI:r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.value,Template:r[o].mAggregations.cells[3].mAggregations.items[1].mProperties.value,Measure:r[o].mAggregations.cells[4].mAggregations.items[1].mProperties.value,EFStandard:r[o].mAggregations.cells[5].mAggregations.items[1].mProperties.value,EmissionLogic:r[o].mAggregations.cells[8].mAggregations.items[1].mProperties.value,BiogenicEmissions:r[o].mAggregations.cells[9].mAggregations.items[1].mProperties.value,Scope:r[o].mAggregations.cells[10].mAggregations.items[1].mProperties.value,EnergyLogic:r[o].mAggregations.cells[11].mAggregations.items[1].mProperties.value,EnergyUse:r[o].mAggregations.cells[12].mAggregations.items[1].mProperties.value,RenNon:r[o].mAggregations.cells[13].mAggregations.items[1].mProperties.value,Supplier:r[o].mAggregations.cells[14].mAggregations.items[1].mProperties.value,ReportingStandard:"GRI",GRIStd:r[o].mAggregations.cells[16].mAggregations.items[1].mProperties.value,SDG:r[o].mAggregations.cells[17].mAggregations.items[1].mProperties._semanticFormValue}}else if(e==="SocialKPIList"){var g={Type:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value,SubType:r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.value,KPI:r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.value,InfoType:r[o].mAggregations.cells[3].mAggregations.items[1].mProperties.value,Template:r[o].mAggregations.cells[4].mAggregations.items[1].mProperties.value,Prefix:this.socialPrefix,Logic:r[o].mAggregations.cells[6].mAggregations.items[1].mProperties.value,GRIStd:r[o].mAggregations.cells[7].mAggregations.items[1].mProperties.value,SDG:r[o].mAggregations.cells[8].mAggregations.items[1].mProperties.value}}else if(e==="uomVolumeTbl"){var u=this.UOMSelected;var n=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var g={Industry:""+n,Measure:""+u,Unit:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value,Abbreviation:r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.value}}else if(e==="EmissionFactorsTbl"){var d=this.KPITypeSelected;var n=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var g={Industry:""+n,KPI:r[o].getCells()[0].mAggregations.items[1].mProperties.selectedKey,Type:""+d,SubType:a.getView().byId("EF_Type").getSelectedKey(),Standard:this.EFTypeSelected,EmissionFactor:r[o].getCells()[2].mAggregations.items[1].mProperties.value,UoM:r[o].getCells()[3].mAggregations.items[1].mProperties.value,Deno:r[o].getCells()[3].mAggregations.items[1].mProperties.value.substring(r[o].getCells()[3].mAggregations.items[1].mProperties.value.lastIndexOf("/")+1),Shortlong:r[o].getCells()[4].mAggregations.items[1].mProperties.selectedKey,class:r[o].getCells()[5].mAggregations.items[1].mProperties.selectedKey,Nume:r[o].getCells()[3].mAggregations.items[1].mProperties.value.substring(0,r[o].getCells()[3].mAggregations.items[1].mProperties.value.indexOf("/"))}}else if(e==="uomConVolTbl"){var m=this.UOMConversionMeasure;var n=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var g={Industry:""+n,Measure:""+m,UserInputUnit:r[o].getCells()[0].mAggregations.items[1].mProperties.selectedKey,ExpectedOutputUnit:r[o].getCells()[1].mAggregations.items[1].mProperties.selectedKey,ConverstionFactor:r[o].getCells()[2].mAggregations.items[1].mProperties.value,Operation:r[o].getCells()[3].mAggregations.items[1].mProperties.selectedKey}}else if(e==="energyConvTbl"){var c=this.KPITypeSelected;var n=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var g={Industry:""+n,KPI:r[o].getCells()[0].mAggregations.items[1].mProperties.selectedKey,Type:""+c,Subtype:a.getView().byId("Sub_Type").getSelectedKey(),UserInputUnit:r[o].getCells()[1].mAggregations.items[1].mProperties.selectedKey,ExpectedOutputUnit:r[o].getCells()[2].mAggregations.items[1].mProperties.selectedKey,ConverstionFactor:r[o].getCells()[3].mAggregations.items[1].mProperties.value,Operation:r[o].getCells()[4].mAggregations.items[1].mProperties.selectedKey}}else if(e==="measureConvsTbl"){var m=this.UOMConversionMeasure;var n=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var g={Industry:""+n,InputMeasureType:""+m,InputUom:r[o].getCells()[0].mAggregations.items[1].mProperties.selectedKey,OutputMeasureType:r[o].getCells()[1].mAggregations.items[1].mProperties.selectedKey,OutputUoM:r[o].getCells()[2].mAggregations.items[1].mProperties.selectedKey,ConverstionFactor:r[o].getCells()[3].mAggregations.items[1].mProperties.value,Operation:r[o].getCells()[4].mAggregations.items[1].mProperties.selectedKey}}else if(e==="generalTbl"){var n=this.GlobalIndustryModel.getData().Industry;var g={ID:"Measure",Value:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value,Industry:""+n}}else if(e==="tblDivision"){var n=this.GlobalIndustryModel.getData().Industry;var g={Division:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value,Industry:""+n}}else if(e==="tblLocation"){var n=this.GlobalIndustryModel.getData().Industry;var g={Location:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value,Industry:""+n}}else if(e==="prefixTypesTbl"){var g={prefix:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value}}else if(e==="prefixValuesTbl"){var p=this.PrefixSelected;var g={prefix:""+p,value:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value}}else if(e==="generalYearTbl"){const e=["January","February","March","April","May","June","July","August","September","October","November","December"];var f=r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue;var v=r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getDate();var h=String(r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getMonth()+1).padStart(2,"0");var y=r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getFullYear();var b=+v+"-"+e[f.getMonth()]+"-"+y;console.log("The fromDate2 is : "+b);var M=r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue;var I=r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getDate();var w=String(r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getMonth()+1).padStart(2,"0");var S=r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getFullYear();var P=+I+"-"+e[M.getMonth()]+"-"+S;console.log("The toDate2 is : "+P);var T=r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getFullYear();var D=r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getFullYear();var V=r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getDate()+"/"+(r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getMonth()+1)+"/"+r[o].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getFullYear();var E=r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getDate()+"/"+(r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getMonth()+1)+"/"+r[o].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getFullYear();var C="";var n=this.GlobalIndustryModel.getData().Industry;if(T===D){C=T;var g={Industry:""+n,YearL:""+T,YearR:""+D,YearA:""+C,StartDate:""+b,EndDate:""+P,fiscal:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value}}else{C=T+"-"+D;var g={Industry:""+n,YearL:""+T,YearR:""+D,YearA:""+C,StartDate:""+b,EndDate:""+P,fiscal:r[o].mAggregations.cells[0].mAggregations.items[1].mProperties.value}}r[o].getCells()[3].setText(C);console.log("yearA:"+C)}console.log("Before call Create Service:: "+g);if(g!==null||g!==undefined||g!==""){s="/"+s;a.batchModel.create(s,g,{method:"POST",success:function(e){sap.m.MessageBox.show("Record created successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){console.log("error:"+JSON.parse(e.responseText).error.message.value);if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}})}}}},onUpdateEntry_Table:function(e,s){var a=this;this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchChanges=[];var i="",r="",o="";var l;if(e==="KPIListTbl"){l=this.getView().byId(e).getModel("KPIModel")}else if(e==="EmissionFactorsTbl"){l=this.getView().byId(e).getModel("EmissionFactorsModel")}else if(e==="uomConVolTbl"){l=this.getView().byId(e).getModel("UOMConvModel")}else if(e==="energyConvTbl"){l=this.getView().byId(e).getModel("EnergyConvModel")}else if(e==="tblDivision"){l=this.getView().byId(e).getModel("divisionModel")}else if(e==="generalYearTbl"){l=this.getView().byId(e).getModel("yearModel")}else if(e==="measureConvsTbl"){l=this.getView().byId(e).getModel("measureConvsModel")}else{l=a.getView().byId(e).getModel()}var n=this.getView().byId(e).getSelectedItems();var g={items:[]};for(var u=0;u<n.length;u++){if(e==="KPIListTbl"){i=n[u].mAggregations.cells[0].mAggregations.items[0].mProperties.text;r=n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text;o=n[u].mAggregations.cells[2].mAggregations.items[0].mProperties.text;var d=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var m={Template:n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value,Measure:n[u].mAggregations.cells[4].mAggregations.items[1].mProperties.value,EFStandard:n[u].mAggregations.cells[5].mAggregations.items[1].mProperties.value,EmissionLogic:n[u].mAggregations.cells[8].mAggregations.items[1].mProperties.value,BiogenicEmissions:n[u].mAggregations.cells[9].mAggregations.items[1].mProperties.value,Scope:n[u].mAggregations.cells[10].mAggregations.items[1].mProperties.value,EnergyLogic:n[u].mAggregations.cells[11].mAggregations.items[1].mProperties.value,EnergyUse:n[u].mAggregations.cells[12].mAggregations.items[1].mProperties.value,RenNon:n[u].mAggregations.cells[13].mAggregations.items[1].mProperties.value,Supplier:n[u].mAggregations.cells[14].mAggregations.items[1].mProperties.value,ReportingStandard:"GRI",GRIStd:n[u].mAggregations.cells[16].mAggregations.items[1].mProperties.value,SDG:n[u].mAggregations.cells[17].mAggregations.items[1].mProperties._semanticFormValue};var c="/"+s+"(Industry='"+d+"',KPI='"+o+"',Type='"+i+"',SubType='"+r+"')";var p=encodeURI(c);a.batchModel.update(p,m,{method:"PUT",success:function(e){sap.m.MessageBox.show("Details updated successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}});a.getView().byId(e).getModel().refresh()}else if(e==="SocialKPIList"){var i=n[u].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var r=n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var o=n[u].mAggregations.cells[2].mAggregations.items[0].mProperties.text;var m={Template:n[u].mAggregations.cells[3].mAggregations.items[0].mProperties.text,GRIStd:n[u].mAggregations.cells[6].mAggregations.items[0].mProperties.text,SDG:n[u].mAggregations.cells[7].mAggregations.items[1].getProperty("selectedKeys").toString(),Logic:n[u].mAggregations.cells[5].mAggregations.items[0].mProperties.text,Prefix:n[u].mAggregations.cells[4].mAggregations.items[0].mProperties.text};a.getView().byId(e).getModel().getData().results[u].GRIStd=m["GRIStd"];a.getView().byId(e).getModel().getData().results[u].Logic=m["Logic"];a.getView().byId(e).getModel().getData().results[u].Prefix=m["Prefix"];a.getView().byId(e).getModel().getData().results[u].SDG=m["SDG"];a.getView().byId(e).getModel().getData().results[u].Template=m["Template"];var c=s+"(KPI='"+o+"',Type='"+i+"',SubType='"+r+"')";var p=encodeURI(c);a.batchChanges.push(a.batchModel.createBatchOperation(p,"PATCH",m));a.getView().byId(e).getModel().refresh()}else if(e==="uomVolumeTbl"){var d=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var f=this.UOMSelected;var v=n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var h=n[u].mAggregations.cells[0].mAggregations.items[1].mProperties.value;var m={Unit:n[u].mAggregations.cells[0].mAggregations.items[1].mProperties.value};var c="/"+s+"(Industry='"+d+"',Measure='"+f+"',Abbreviation='"+v+"')";var p=encodeURI(c);a.batchModel.update(p,{Unit:h},{method:"PUT",success:function(e){sap.m.MessageBox.show("Details updated successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}});a.getView().byId(e).getModel().refresh()}else if(e==="EmissionFactorsTbl"){var d=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var i=this.KPITypeSelected;var r=a.getView().byId("EF_Type").getSelectedKey();var y=n[u].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var b=n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var M=n[u].mAggregations.cells[4].mAggregations.items[0].mProperties.text;var I=n[u].mAggregations.cells[5].mAggregations.items[0].mProperties.text;var m={EmissionFactor:n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.value,UoM:n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value,Deno:n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value.substring(n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value.lastIndexOf("/")+1),Nume:n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value.substring(0,n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value.indexOf("/"))};var c="/"+s+"(Industry='"+d+"',KPI='"+y+"',Type='"+i+"',SubType='"+r+"',Standard='"+b+"',Shortlong='"+M+"',class='"+I+"')";var p=encodeURI(c);a.batchModel.update(p,m,{method:"PUT",success:function(e){sap.m.MessageBox.show("Details updated successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}});a.getView().byId(e).getModel().refresh()}else if(e==="uomConVolTbl"){var d=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var w=this.UOMConversionMeasure;var f=w;var S=n[u].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var P=n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var m={ConverstionFactor:n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.value,Operation:n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.selectedKey};console.log("json3:"+m);var c="/"+s+"(Industry='"+d+"',Measure='"+f+"',UserInputUnit='"+S+"',ExpectedOutputUnit='"+P+"')";var p=encodeURI(c);a.batchModel.update(p,m,{method:"PUT",success:function(e){sap.m.MessageBox.show("Details updated successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}});a.getView().byId(e).getModel().refresh()}else if(e==="measureConvsTbl"){var d=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var w=this.UOMConversionMeasure;var T=w;var m={InputUom:n[u].mAggregations.cells[0].mAggregations.items[0].mProperties.text,OutputMeasureType:n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text,OutputUoM:n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text,ConverstionFactor:n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value,Operation:n[u].mAggregations.cells[4].mAggregations.items[1].mProperties.selectedKey};console.log("json3:"+m);var c="/"+s+"(Industry='"+d+"',InputMeasureType='"+T+"')";var p=encodeURI(c);a.batchModel.update(p,m,{method:"PUT",success:function(e){sap.m.MessageBox.show("Details updated successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}});a.getView().byId(e).getModel().refresh()}else if(e==="energyConvTbl"){var d=this.GlobalIndustryModel.getData().Industry;var D=this.KPITypeSelected;var i=D;var V=a.getView().byId("Sub_Type").getSelectedKey();var y=n[u].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var S=n[u].mAggregations.cells[1].mAggregations.items[0].mProperties.text;var m={ExpectedOutputUnit:n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.selectedKey,ConverstionFactor:n[u].mAggregations.cells[3].mAggregations.items[1].mProperties.value,Operation:n[u].mAggregations.cells[4].mAggregations.items[1].mProperties.selectedKey};var c="/"+s+"(Industry='"+d+"',KPI='"+y+"',Type='"+i+"',Subtype='"+V+"',UserInputUnit='"+S+"')";var p=encodeURI(c);a.batchModel.update(p,m,{method:"PUT",success:function(e){sap.m.MessageBox.show("Details updated successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}});a.getView().byId(e).getModel().refresh()}else if(e==="generalYearTbl"){var d=this.GlobalIndustryModel.getData().Industry;const i=["January","February","March","April","May","June","July","August","September","October","November","December"];var E=n[u].mAggregations.cells[0].mAggregations.items[0].mProperties.text;var C=n[u].mAggregations.cells[3].mProperties.text;var A=n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue;var x=n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getDate();var O=String(n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getMonth()+1).padStart(2,"0");var F=n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getFullYear();var _=+x+"-"+i[A.getMonth()]+"-"+F;console.log("The fromDate2 is : "+_);var U=n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue;var N=n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getDate();var K=String(n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getMonth()+1).padStart(2,"0");var R=n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getFullYear();var G=+N+"-"+i[U.getMonth()]+"-"+R;console.log("The toDate2 is : "+G);var L=n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getFullYear();var B=n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getFullYear();var q=n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getDate()+"/"+(n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getMonth()+1)+"/"+n[u].mAggregations.cells[1].mAggregations.items[1].mProperties.dateValue.getFullYear();var Y=n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getDate()+"/"+(n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getMonth()+1)+"/"+n[u].mAggregations.cells[2].mAggregations.items[1].mProperties.dateValue.getFullYear();var m={Industry:""+d,YearR:""+B,YearA:""+C,StartDate:""+_,EndDate:""+G};console.log("year json3:"+m);var c="/"+s+"(YearL='"+L+"',fiscal='"+E+"')";console.log("year uri1:"+c);var p=encodeURI(c);a.batchModel.update(p,m,{method:"PUT",success:function(e){sap.m.MessageBox.show("Details updated successfully.",{icon:t.Icon.INFORMATION,title:"Information",actions:[t.Action.YES],emphasizedAction:t.Action.YES})},error:function(e){if(JSON.parse(e.responseText).error.code!="202"){sap.m.MessageBox.show(JSON.parse(e.responseText).error.message.value,{title:"Error"})}}});a.getView().byId(e).getModel().refresh()}}},formatEmissionFactor:function(e){if(e==="BUSINESS TRAVEL"){this.getView().byId("shortLongColn").setVisible(true);this.getView().byId("classColn").setVisible(true);return true}else{this.getView().byId("shortLongColn").setVisible(false);this.getView().byId("classColn").setVisible(false);return false}},formatEditField:function(e,t,s){if(e||t){return true}else if(s){return false}},formatDisplayField:function(e,t,s){if(e||t){return false}else if(s){return true}},formatPKeyField:function(e,t,s){if(e){return false}else if(s||t){return true}},formatDivisionText:function(e){console.log("Industry:"+e);if(e==="IT"){return"ITs"}else if(e==="Ports"){return"Port"}else{return"no value"}},calloData_GRIStds:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/Standards_Module";var i=this.byId("firstTabl");this.GRIStdModel=new sap.ui.model.json.JSONModel;s.read(a,{success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.GRIStdModel.setData(t)},error:function(e){t.error("Error")}})},calloData_Division:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/Division";var i=this.GlobalIndustryModel.getData().Industry;var r=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:i});this.DivisionModel=new sap.ui.model.json.JSONModel;s.read(a,{filters:[r],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.DivisionModel.setData(t);console.log(e.DivisionModel);console.log("ListModel:"+a);var i=t.results.length;for(var r=0;r<i;r++){e.DivisionModel.getData().results[r].isExistingRow=true;e.DivisionModel.getData().results[r].isNewRow=false;e.DivisionModel.getData().results[r].isEditableRow=false}e.getView().byId("tblDivision").setModel(e.DivisionModel,"divisionModel")},error:function(e){t.error("Error")}})},calloData_Location:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/Location";var i=this.GlobalIndustryModel.getData().Industry;var r=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:i});this.LocationModel=new sap.ui.model.json.JSONModel;s.read(a,{filters:[r],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.LocationModel.setData(t);console.log(e.LocationModel);console.log("ListModel:"+a);var i=t.results.length;for(var r=0;r<i;r++){e.LocationModel.getData().results[r].isExistingRow=true;e.LocationModel.getData().results[r].isNewRow=false;e.LocationModel.getData().results[r].isEditableRow=false}e.getView().byId("tblLocation").setModel(e.LocationModel,"locationModel")},error:function(e){t.error("Error")}})},calloData_General:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/Constants_Telecom";var i=this.GlobalIndustryModel.getData().Industry;var r=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:i});this.GeneralModel=new sap.ui.model.json.JSONModel;s.read(a,{filters:[r],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.GeneralModel.setData(t);console.log(e.GeneralModel);console.log("ListModel:"+a);var i=t.results.length;for(var r=0;r<i;r++){e.GeneralModel.getData().results[r].isExistingRow=true;e.GeneralModel.getData().results[r].isNewRow=false;e.GeneralModel.getData().results[r].isEditableRow=false}e.getView().byId("GroupMeasure").setModel(e.GeneralModel,"generalModel");e.getView().byId("cbUOMConv3_Measure").setModel(e.GeneralModel,"generalModel");e.getView().byId("generalTbl").setModel(e.GeneralModel,"generalModel");e.getView().byId("GroupA").setModel(e.GeneralModel,"generalModel");e.getView().byId("GroupB").setModel(e.GeneralModel,"generalModel")},error:function(e){t.error("Error")}})},calloData_General_Year:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/Year_Module";var i=this.GlobalIndustryModel.getData().Industry;var r=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:i});this.YearModel=new sap.ui.model.json.JSONModel;s.read(a,{filters:[r],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.YearModel.setData(t);console.log(e.YearModel);console.log("ListModel:"+a);var i=t.results.length;for(var r=0;r<i;r++){e.YearModel.getData().results[r].isExistingRow=true;e.YearModel.getData().results[r].isNewRow=false;e.YearModel.getData().results[r].isEditableRow=false}e.getView().byId("generalYearTbl").setModel(e.YearModel,"yearModel")},error:function(e){t.error("Error")}})},calloData_UOM:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var i=this.UOMSelected;var r=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:a})],and:true});this.UOMModel=new sap.ui.model.json.JSONModel;s.read("/UOM",{filters:[r],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.UOMModel.setData(t);console.log(e.UOMModel);console.log("ListModel:"+a);e.getView().byId("cbUOMConv").setModel(a,"UOMListModel");e.getView().byId("cbUOMConv2").setModel(a,"UOMListModel");e.getView().byId("cbUOMConv_Measure").setModel(a,"UOMListModel");var i=new sap.ui.model.json.JSONModel;var r=t.results.length;for(var o=0;o<r;o++){e.UOMModel.getData().results[o].isExistingRow=true;e.UOMModel.getData().results[o].isNewRow=false;e.UOMModel.getData().results[o].isEditableRow=false}e.getView().byId("uomVolumeTbl").setModel(e.UOMModel);sap.ui.getCore().setModel(a,"EnergyListModel");e.getView().byId("cbEnergyConvIP").setModel(i,"FilterEnergy");e.getView().byId("cbEnergyConvOP").setModel(a,"EnergyListModel")},error:function(e){t.error("Error")}})},calloData_Conversions:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var i=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:a});this.UOMConvModel=new sap.ui.model.json.JSONModel;s.read("/UoMConversions",{filters:[i],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.UOMConvModel.setData(t);var i=t.results.length;for(var r=0;r<i;r++){e.UOMConvModel.getData().results[r].isExistingRow=true;e.UOMConvModel.getData().results[r].isNewRow=false;e.UOMConvModel.getData().results[r].isEditableRow=false}e.getView().byId("uomConVolTbl").setModel(e.UOMConvModel,"UOMConvModel")},error:function(e){t.error("Error")}});this.EnergyConvModel=new sap.ui.model.json.JSONModel;var a=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var i=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:a});s.read("/EnergyCnversions",{filters:[i],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.EnergyConvModel.setData(t);var i=t.results.length;for(var r=0;r<i;r++){e.EnergyConvModel.getData().results[r].isExistingRow=true;e.EnergyConvModel.getData().results[r].isNewRow=false;e.EnergyConvModel.getData().results[r].isEditableRow=false}e.getView().byId("energyConvTbl").setModel(e.EnergyConvModel,"EnergyConvModel")},error:function(e){t.error("Error")}})},calloData_EnergyConversions:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");this.EnergyConvModel=new sap.ui.model.json.JSONModel;var a=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var i=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:a});s.read("/EnergyCnversions",{filters:[i],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.EnergyConvModel.setData(t);var i=t.results.length;for(var r=0;r<i;r++){e.EnergyConvModel.getData().results[r].isExistingRow=true;e.EnergyConvModel.getData().results[r].isNewRow=false;e.EnergyConvModel.getData().results[r].isEditableRow=false}e.getView().byId("energyConvTbl").setModel(e.EnergyConvModel,"EnergyConvModel")},error:function(e){t.error("Error")}})},calloData_MeasureConversions:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");this.measureConvsModel=new sap.ui.model.json.JSONModel;var a=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var i=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:a});s.read("/Measure_Module",{filters:[i],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.measureConvsModel.setData(t);var i=t.results.length;for(var r=0;r<i;r++){e.measureConvsModel.getData().results[r].isExistingRow=true;e.measureConvsModel.getData().results[r].isNewRow=false;e.measureConvsModel.getData().results[r].isEditableRow=false}e.getView().byId("measureConvsTbl").setModel(e.measureConvsModel,"measureConvsModel")},error:function(e){t.error("Error")}})},calloData_KPIList_Social:function(){var e=this;var t=this.getOwnerComponent().getModel("dataModel");t.read("/KPIList_Social_Ports",{success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);var i=t.results.length;for(var r=0;r<i;r++){a.getData().results[r].isExistingRow=true;a.getData().results[r].isNewRow=false;a.getData().results[r].isEditableRow=false}e.getView().byId("SocialKPIList").setModel(a)},error:function(e){}})},calloData_KPIList:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/KPIList";var i=this.GlobalIndustryModel.getData().Industry;var r=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:i});s.read(a,{filters:[r],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);var i=t.results.length;for(var r=0;r<i;r++){a.getData().results[r].isExistingRow=true;a.getData().results[r].isNewRow=false;a.getData().results[r].isEditableRow=false;if(a.getData().results[r].SDG!=null){let e=a.getData().results[r].SDG.split(",").join("\n ");a.getData().results[r].SDG="";a.getData().results[r].SDG=e;let t=a.getData().results[r].GRIStd.split(";,").join("\n ");a.getData().results[r].GRIStd="";a.getData().results[r].GRIStd=t}}e.getView().byId("KPIListTbl").setModel(a,"KPIModel");e.getView().byId("EF_Type").setModel(a,"KPIModel");e.getView().byId("KPI").setModel(a,"KPIModel");e.getView().byId("energyConvTbl").setModel(a,"EnergyModel");e.getView().byId("Sub_Type").setModel(a,"EnergyModel");e.getView().byId("KPI_Energy").setModel(a,"EnergyModel");var o=[];var l=t.results;for(var r=0;r<l.length;r++){if(o.indexOf(l[r].Type)===-1){o.push(l[r].Type)}}console.log("subType:"+o);var n={items:o};var g=new sap.ui.model.json.JSONModel;g.setData(n.items);var u=e.getView().byId("GroupC");u.setModel(g,"EmissionModel");var d=e.getView().byId("EmissonFactors");d.setModel(g,"EmissionModel");console.log(g);e.KPITypeSelected=g.getData()[0];e._getFilterData_KPI_EF();e._getEmissionFactorData()},error:function(e){t.error("Error")}})},calloData_EF:function(){var e=this;var t=new sap.m.BusyDialog({});t.open();var s=this.getOwnerComponent().getModel("dataModel");this.EmissionFactorsModel=new sap.ui.model.json.JSONModel;s.read("/EmissionFactors",{success:function(s,a){t.close();var i=new sap.ui.model.json.JSONModel;i.setData(s);e.EmissionFactorsModel.setData(s);var r=s.results.length;for(var o=0;o<r;o++){e.EmissionFactorsModel.getData().results[o].isExistingRow=true;e.EmissionFactorsModel.getData().results[o].isNewRow=false;e.EmissionFactorsModel.getData().results[o].isEditableRow=false}e.getView().byId("EmissionFactorsTbl").setModel(e.EmissionFactorsModel,"EmissionFactorsModel")},error:function(e){t.close()}})},calloData_Prefix_Types:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/Prefix_Types";this.PrefixTypesModel=new sap.ui.model.json.JSONModel;s.read(a,{success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.PrefixTypesModel.setData(t);console.log(e.PrefixTypesModel);console.log("ListModel:"+a);var i=t.results.length;for(var r=0;r<i;r++){e.PrefixTypesModel.getData().results[r].isExistingRow=true;e.PrefixTypesModel.getData().results[r].isNewRow=false;e.PrefixTypesModel.getData().results[r].isEditableRow=false}e.getView().byId("prefixTypesTbl").setModel(e.PrefixTypesModel,"PrefixTypesModel");e.getView().byId("prefixValues_RBtn").setModel(e.PrefixTypesModel,"PrefixTypesModel");e.getView().byId("prefixKPI").setModel(e.PrefixTypesModel,"PrefixTypesModel")},error:function(e){t.error("Error")}})},calloData_Prefix_Values:function(){var e=this;var s=this.getOwnerComponent().getModel("dataModel");var a="/Prefix_Values";var i=this.PrefixSelected;var r=new sap.ui.model.Filter({path:"prefix",operator:sap.ui.model.FilterOperator.EQ,value1:i});this.PrefixValuesModel=new sap.ui.model.json.JSONModel;s.read(a,{success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.PrefixValuesModel.setData(t);var i=t.results.length;for(var r=0;r<i;r++){e.PrefixValuesModel.getData().results[r].isExistingRow=true;e.PrefixValuesModel.getData().results[r].isNewRow=false;e.PrefixValuesModel.getData().results[r].isEditableRow=false}e.getView().byId("prefixValuesTbl").setModel(e.PrefixValuesModel,"PrefixValuesModel")},error:function(e){t.error("Error")}})},callODataService:function(){var e=this;var t=this.getOwnerComponent().getModel("dataModel");t.read("/Constants",{success:function(t,s){console.log("success");var a=new sap.ui.model.json.JSONModel;a.setData(t);e.getView().setModel(a,"ConstantsModel")},error:function(e){console.log("Error")}});this.calloData_Prefix_Types();this.calloData_Prefix_Values();this.calloData_UOM();this.calloData_Conversions();this.calloData_MeasureConversions();this.calloData_EnergyConversions();this.calloData_KPIList();this.calloData_KPIList_Social();this.calloData_EF();this.calloData_General();this.calloData_Division();this.calloData_Location();this.calloData_General_Year()},onUpdateFinished:function(){var e=this.GlobalIndustryModel.getData().Industry},_getKPISubTypes:function(){var e=this;var t=e.getView().byId("KPISubType").getModel("KPIModel");var s=this.KPITypeSelected;var a=[];var i=[];var r=t.getData().results;for(var o=0;o<r.length;o++){if(r[o].Type===s){for(var l=0;l<r.length;l++){if(a.indexOf(r[l].SubType)===-1&&r[l].Type===s){a.push(r[l].SubType)}}}}console.log(a);for(var o=0;o<a.length;o++){var n={};n.SubType=a[o];i.push(n)}console.log(i);var g={items:i};var u=new sap.ui.model.json.JSONModel;u.setData(g);console.log(g);var d=e.getView().byId("KPISubType");d.setModel(u);d.bindAggregation("items","/items",new sap.ui.core.ListItem({text:"{SubType}",key:"{SubType}"}));e.getView().byId("KPISubType").setSelectedKey(a[0]);this.KPISubtypeSelected=a[0];this._getKPIs()},OnPressAddNewEntry_Division:function(e){var t=this;var s={results:[]};s.results=[{Division:"",Industry:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("tblDivision").getModel("divisionModel").getData().results=t.getView().byId("tblDivision").getModel("divisionModel").getProperty("/results").concat(s.results);t.getView().byId("tblDivision").getModel("divisionModel").refresh(true)},OnPressAddNewEntry_Location:function(e){var t=this;var s={results:[]};s.results=[{Location:"",Industry:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("tblLocation").getModel("locationModel").getData().results=t.getView().byId("tblLocation").getModel("locationModel").getProperty("/results").concat(s.results);t.getView().byId("tblLocation").getModel("locationModel").refresh(true)},OnPressAddNewEntry_General:function(e){var t=this;var s=this.UOMSelected;var a={results:[]};a.results=[{Value:""+s,ID:"",Industry:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("generalTbl").getModel("generalModel").getData().results=t.getView().byId("generalTbl").getModel("generalModel").getProperty("/results").concat(a.results);t.getView().byId("generalTbl").getModel("generalModel").refresh(true)},OnPressAddNewEntry_General_Year:function(e){var t=this;var s={results:[]};s.results=[{YearL:"",YearR:"",YearA:"",Vertical:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("generalYearTbl").getModel("yearModel").getData().results=t.getView().byId("generalYearTbl").getModel("yearModel").getProperty("/results").concat(s.results);t.getView().byId("generalYearTbl").getModel("yearModel").refresh(true)},OnPressAddNewEntry_UOM_Volume:function(e){var t=this;var s=this.UOMSelected;var a={results:[]};a.results=[{Measure:""+s,Unit:"",Abbreviation:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("uomVolumeTbl").getModel().getData().results=t.getView().byId("uomVolumeTbl").getModel().getProperty("/results").concat(a.results);t.getView().byId("uomVolumeTbl").getModel().refresh(true);var i=t.getView().byId("uomVolumeTbl").getItems();var r=t.getView().byId("uomVolumeTbl").getItems().length-1},OnPressAddNewEntry_UOM_Convs_Volume:function(e){var t=this;var s={results:[]};var a=this.UOMConversionMeasure;s.results=[{Measure:""+a,UserInputUnit:"",ExpectedOutputUnit:"","":"",ConverstionFactor:"",Operation:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("uomConVolTbl").getModel("UOMConvModel").getData().results=t.getView().byId("uomConVolTbl").getModel("UOMConvModel").getProperty("/results").concat(s.results);t.getView().byId("uomConVolTbl").getModel("UOMConvModel").refresh(true)},OnPressAddNewEntry_Measure_Convs:function(e){var t=this;var s={results:[]};var a=this.UOMConversionMeasure;s.results=[{InputMeasureType:""+a,InputUom:"",OutputUoM:"",OutputMeasureType:"",ConverstionFactor:"",Operation:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("measureConvsTbl").getModel("measureConvsModel").getData().results=t.getView().byId("measureConvsTbl").getModel("measureConvsModel").getProperty("/results").concat(s.results);t.getView().byId("measureConvsTbl").getModel("measureConvsModel").refresh(true)},OnPressAddNewEntry_Energy:function(e){var t=this;var s=this.KPITypeSelected;var a=this.KPISubtypeSelected;var i={results:[]};i.results=[{KPI:"",Type:""+s,Subtype:""+a,UserInputUnit:"",ExpectedOutputUnit:"",ConverstionFactor:"",Operation:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("energyConvTbl").getModel("EnergyConvModel").getData().results=t.getView().byId("energyConvTbl").getModel("EnergyConvModel").getProperty("/results").concat(i.results);t.getView().byId("energyConvTbl").getModel("EnergyConvModel").refresh(true)},OnPressAddNewEntry_KPIList:function(e){var t=this;var s={results:[]};s.results=[{KPI:"",Type:"",SubType:"",Template:"",Measure:"",Standard:"",Logic:"",Standard1:"",Scope:"",GRIStd:"",SDG:"",RENON:"",EnergyUse:"",BiogenicEmissions:"",Supplier:"",isNewRow:true,isExistingRow:false}];t.getView().byId("KPIListTbl").getModel("KPIModel").getData().results=t.getView().byId("KPIListTbl").getModel("KPIModel").getProperty("/results").concat(s.results);t.getView().byId("KPIListTbl").getModel("KPIModel").refresh(true)},OnPressAddNewEntry_SocialKPI:function(e){var t=this;var s={results:[]};s.results=[{KPI:"",Type:"",SubType:"",Template:"",Template:"",Prefix:"",Logic:"",GRIStd:"",GRIStd:"",SDG:"",isNewRow:true,isExistingRow:false,isEditableRow:false,InformationType:""}];t.getView().byId("SocialKPIList").getModel().getData().results=t.getView().byId("SocialKPIList").getModel().getProperty("/results").concat(s.results);t.getView().byId("SocialKPIList").getModel().refresh(true)},OnPressAddNewEntry_PrefixTypes:function(e){var t=this;var s={results:[]};s.results=[{prefix:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("prefixTypesTbl").getModel("PrefixTypesModel").getData().results=t.getView().byId("prefixTypesTbl").getModel("PrefixTypesModel").getProperty("/results").concat(s.results);t.getView().byId("prefixTypesTbl").getModel("PrefixTypesModel").refresh(true)},OnPressAddNewEntry_Prefix_Values:function(e){var t=this;var s=this.PrefixSelected;var a={results:[]};a.results=[{prefix:""+s,value:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("prefixValuesTbl").getModel("PrefixValuesModel").getData().results=t.getView().byId("prefixValuesTbl").getModel("PrefixValuesModel").getProperty("/results").concat(a.results);t.getView().byId("prefixValuesTbl").getModel("PrefixValuesModel").refresh(true)},OnPressAddNewEntry_EF:function(e){var t=this;var s=this.KPITypeSelected;var a=this.KPISubtypeSelected;var i=this.EFTypeSelected;var r={results:[]};r.results=[{KPI:"",Type:""+s,SubType:""+a,Standard:i,EmissionFactor:"",UoM:"",Shortlong:"",class:"",Deno:"",Nume:"",isNewRow:true,isExistingRow:false,isEditableRow:false}];t.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel").getData().results=t.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel").getProperty("/results").concat(r.results);t.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel").refresh(true);if(this.EFTypeSelected==="DEFRA"){var o=t.getView().byId("EmissionFactorsTbl").getItems();var l=t.getView().byId("EmissionFactorsTbl").getItems().length-1;var n=o[l].mAggregations.cells[2].getItems()[1];var g=o[l].mAggregations.cells[3].getItems()[1];console.log("oEFValue:"+n);console.log("oEFUnit:"+g);n.mProperties.editable=false;g.mProperties.editable=false}},OnPressAddNewEntry_Templates:function(e){var t=this;var s={KPI:"LPG",Type:"ENERGY",SubType:"Direct Energy",Template:"Table 1",UomType:"Mass",EmissionFactor:"IPCC",Logic:"Logic 1",Scope:"Scope 1",GRIStd:null,EmissionResults:"13"}},myFunction:function(e){e.getSource().setEditable(true);e.getSource().setEnabled(true)},onSelect_Radiobutton_PrefixValues:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.PrefixSelected=s;var a=[new sap.ui.model.Filter({path:"prefix",operator:sap.ui.model.FilterOperator.EQ,value1:s})];console.log(a);var i=t.getView().byId("prefixValuesTbl");var r=i.getBinding("items");r.filter(a);console.log(r)},onSelect_Radiobutton_UOM:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.UOMSelected=s;var a=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var i=[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:s})];var r=t.getView().byId("uomVolumeTbl");var o=r.getBinding("items");o.filter(i);console.log(o)},_getFilterData_UOMConv:function(e,t,s){var a=new sap.ui.core.ListItem({key:"{UOMListModel>Abbreviation}",text:"{UOMListModel>Abbreviation}"});e.bindAggregation("items",{path:"UOMListModel>/results",template:a,filters:s})},onSelectionChange:function(e){var t=e;var s=e.getSource().getSelectedItems();for(var a=0;a<s.length;a++){var i=e.getSource().getSelectedItems()[a].getCells()[3].getItems()[1].getSelectedKey();var r=e.getSource().getSelectedItems()[a];if(i=="Table 3"||i=="Table 6"){r.getCells()[6].getItems()[1].setEditable(true);r.getCells()[7].getItems()[1].setEditable(true)}}},onSelect_KPIList:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.KPIListTypeSelected=s;if(s==="Environment"){t.getView().byId("KPIListTbl").setVisible(true);t.getView().byId("SocialKPIList").setVisible(false)}else if(s==="Social"){t.getView().byId("KPIListTbl").setVisible(false);t.getView().byId("SocialKPIList").setVisible(true)}},onSelect_Convs:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.ConversionTypeSelected=s;if(s==="UoM Conversions"){t.getView().byId("uom").setVisible(true);t.getView().byId("measure").setVisible(false)}else if(s==="Measure Conversions"){t.getView().byId("uom").setVisible(false);t.getView().byId("measure").setVisible(true)}},onSelect_EF:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.EFTypeSelected=s;if(s==="DEFRA"){t.getView().byId("Defra").setVisible(true);var a=this.KPITypeSelected;var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:a}),new sap.ui.model.Filter({path:"Standard",operator:sap.ui.model.FilterOperator.EQ,value1:s})],and:true});var r=t.getView().byId("EmissionFactorsTbl");var o=r.getBinding("items");console.log(o);o.filter(i);t.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel").refresh(true);var l=t.getView().byId("EmissonFactors");l.setSelectedIndex(0)}else if(s==="User Defined"){t.getView().byId("Defra").setVisible(false);var a=this.KPITypeSelected;var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:a}),new sap.ui.model.Filter({path:"Standard",operator:sap.ui.model.FilterOperator.EQ,value1:s})],and:true});var r=t.getView().byId("EmissionFactorsTbl");var o=r.getBinding("items");console.log(o);o.filter(i);t.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel").refresh(true);var l=t.getView().byId("EmissonFactors");l.setSelectedIndex(0)}},onSelect_Radiobutton_UOMConvs:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.UOMConversionMeasure=s;var a=[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:s})];console.log(a);var i=t.getView().byId("uomConVolTbl");var r=i.getBinding("items");r.filter(a);console.log(r);var o=t.getView().byId("cbUOMConv");var l=t.getView().byId("cbUOMConv").getModel("UOMListModel");this._getFilterData_UOMConv(o,l,a);var n=t.getView().byId("cbUOMConv2");var g=t.getView().byId("cbUOMConv2").getModel("UOMListModel");this._getFilterData_UOMConv(n,g,a)},onSelect_Radiobutton_MeasureConvs:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.UOMConversionMeasure=s;var a=[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:s})];var i=[new sap.ui.model.Filter({path:"InputMeasureType",operator:sap.ui.model.FilterOperator.EQ,value1:s})];console.log(a);var r=t.getView().byId("measureConvsTbl");var o=r.getBinding("items");o.filter(i);console.log(o);var l=t.getView().byId("cbUOMConv_Measure");var n=t.getView().byId("cbUOMConv_Measure").getModel("UOMListModel");this._getFilterData_UOMConv(l,n,a)},onChangeTemplate:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.Template=t;var s=this.getView().byId("KPIListTbl").getItems().length-1;if(t==="Table 3"||t==="Table 6"){this.getView().byId("KPIListTbl").getItems()[s].getCells()[6].getItems()[1].setEditable(false);this.getView().byId("KPIListTbl").getItems()[s].getCells()[7].getItems()[1].setEditable(false)}else{this.getView().byId("KPIListTbl").getItems()[s].getCells()[6].getItems()[1].setEditable(true);this.getView().byId("KPIListTbl").getItems()[s].getCells()[7].getItems()[1].setEditable(true)}if(t==="Table 2"){this.getView().byId("KPIListTbl").getColumns()[6].setVisible(true);this.getView().byId("KPIListTbl").getColumns()[7].setVisible(true)}else{this.getView().byId("KPIListTbl").getColumns()[6].setVisible(false);this.getView().byId("KPIListTbl").getColumns()[7].setVisible(false)}},onChangeUomType:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.Measure=t},onChangeEmissionFactor:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.Standard=t},onCollapseAll:function(e){var t=this.byId("firstTabl");t.collapseAll()},onCollapseSelection:function(e){var t=this.byId("firstTabl");t.collapse(t.getSelectedIndices())},onExpandFirstLevel:function(e){var t=this.byId("firstTabl");t.expandToLevel(1)},onExpandSelection:function(e){var t=this.byId("firstTabl");t.expand(t.getSelectedIndices())},onPressCancelGRI:function(e){if(!this._gDialog){this._gDialog=sap.ui.core.Fragment.load({id:that.getView().getId(),name:"com.techm.sustainabilityui.fragment.GRIStd1",controller:that}).then(function(e){that.getView().addDependent(e);return e})}this._gDialog.then(function(e){e.close()})},onPressOkGRI:function(e){var s=this.byId("firstTabl");var a=[];var i=s.getSelectedIndices();var r="";var o="";var l=[];for(var n=0;n<i.length;n++){var g=s.getContextByIndex(i[n]);var u=s.getModel().getProperty(g.getPath());a.push(u);o=u.DrillState;if(o==="expanded"){sap.m.MessageBox.show("Please Select Leaf Node..",{icon:t.Icon.WARNING,title:"Warning"});l=""}else{r=u.Description;l.push(r+";")}}var d=l.toString();console.log("a:"+d);console.log("a:"+d.length);var m=d.slice(0,-1);console.log("b:"+m);console.log("b:"+m.length);var c=this;var p=c.getView().byId("KPIListTbl").getItems();var f=c.getView().byId("KPIListTbl").getItems().length-1;var v=p[f].mAggregations.cells[16].getItems()[1];var h=this.getView().byId("KPIListTbl").getModel("KPIModel");for(var n=0;n<h.getData().results.length;n++){if(h.getData().results[n].isNewRow){v.setValue(m)}}if(!this._gDialog){this._gDialog=sap.ui.core.Fragment.load({id:c.getView().getId(),name:"com.techm.sustainabilityui.fragment.GRIStd1",controller:c}).then(function(e){c.getView().addDependent(e);return e})}this._gDialog.then(function(e){e.close()})},onChangeGRIStd:function(e){var t=this;if(!this._gDialog){this._gDialog=sap.ui.core.Fragment.load({id:t.getView().getId(),name:"com.techm.sustainabilityui.fragment.GRIStd1",controller:t}).then(function(e){t.getView().addDependent(e);return e})}this._gDialog.then(function(e){t.callBindings();e.open()})},onChangeStdValue_EF:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.KPI_EF=t},onChangeKPI:function(e){var s=e.getParameter("selectedItem").getText();console.log(s);this.EFStandard=s;if(this.EFTypeSelected==="DEFRA"){var a=e.getSource(),i=this.getView();var r=e.getSource().getValue(),i=this.getView();if(!this._pDialog){this._pDialog=sap.ui.core.Fragment.load({id:i.getId(),name:"com.techm.sustainabilityui.fragment.Defra",controller:this}).then(function(e){i.addDependent(e);return e})}var o=this;this._pDialog.then(function(e){var s=o.getOwnerComponent().getModel("dataModel");var a="/Emission_Module";var i=o.getView().byId("defraYear").getSelectedKey();var l=new sap.ui.model.Filter({path:"YearL",operator:sap.ui.model.FilterOperator.EQ,value1:i});o.DefraModel=new sap.ui.model.json.JSONModel;s.read(a,{filters:[l],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);o.DefraModel.setData(t);console.log(o.DefraModel);console.log("ListModel:"+a);o.getView().setModel(o.DefraModel,"defraModel");e.setModel(o.DefraModel)},error:function(e){t.error("Error")}});e.open(r)})}},onChangeDefraYear:function(e){},handleSearch:function(e){var t,s;t=[];var a=e.getParameter("value");t.push(new sap.ui.model.Filter("scope",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("Level1",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("Level2",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("Level3",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("Level4",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("ColumnText",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("UomSimple",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("Uom",sap.ui.model.FilterOperator.Contains,a));t.push(new sap.ui.model.Filter("GHG",sap.ui.model.FilterOperator.Contains,a));s=new sap.ui.model.Filter({filters:t,and:false});var i=e.getSource().getBinding("items");i.filter([s])},handleClose:function(e){var t=this;var s=e.getSource().getBinding("items");s.filter([]);var a=e.getParameter("selectedContexts");if(a&&a.length){var i=t.getView().byId("EmissionFactorsTbl").getItems();var r=t.getView().byId("EmissionFactorsTbl").getItems().length-1;var o=i[r].mAggregations.cells[2].getItems()[1];var l=i[r].mAggregations.cells[3].getItems()[1];var n=this.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel");for(var g=0;g<n.getData().results.length;g++){if(n.getData().results[g].isNewRow){o.setValue(a.map(function(e){return e.getObject().GHGConversionFactor2021}).join(", "));var u=a.map(function(e){return e.getObject().GHG}).join(", ");var d=a.map(function(e){return e.getObject().UomSimple}).join(", ");l.setValue(u.replaceAll(" ","")+"/"+d)}}}},handleFilterButtonPressed:function(){this.getViewSettingsDialog("com.techm.sustainabilityui.fragment.DefraFilter").then(function(e){e.open()})},getViewSettingsDialog:function(e){var t=this._mViewSettingsDialogs[e];if(!t){t=sap.ui.core.Fragment.load({id:this.getView().getId(),name:e,controller:this});this._mViewSettingsDialogs[e]=t}return t},handleFilterDialogConfirm:function(e){var t=this.byId("myDialog"),s=e.getParameters(),a=t.getBinding("items"),i=[];s.filterItems.forEach(function(e){var t=e.getKey().split("___"),s=t[0],a=t[1],r=t[2],o=t[3],l=new sap.ui.model.Filter(s,a,r,o);i.push(l)});a.filter(i);this.byId("vsdFilterBar").setVisible(i.length>0);this.byId("vsdFilterLabel").setText(s.filterString)},onSelectDefraValues:function(e){var t=e.getParameter("listItem");var s=this;var a=e.getSource().getBinding("items");a.filter([]);{var i=s.getView().byId("EmissionFactorsTbl").getItems();var r=s.getView().byId("EmissionFactorsTbl").getItems().length-1;var o=i[r].mAggregations.cells[2].getItems()[1];var l=i[r].mAggregations.cells[3].getItems()[1];var n=this.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel");for(var g=0;g<n.getData().results.length;g++){if(n.getData().results[g].isNewRow){o.setValue(t.getBindingContext().getProperty("ConvFactor"));var u=t.getBindingContext().getProperty("GHG");var d=t.getBindingContext().getProperty("UOM");l.setValue(u.replaceAll(" ","")+"/"+d);e.getSource().getParent().close()}}}},_configDialog:function(e,t){var s=e.data("draggable");t.setDraggable(s=="true");var a=e.data("resizable");t.setResizable(a=="true");var i=!!e.data("multi");t.setMultiSelect(i);var r=!!e.data("remember");t.setRememberSelections(r);var o=e.data("responsivePadding");var l="sapUiResponsivePadding--header sapUiResponsivePadding--subHeader sapUiResponsivePadding--content sapUiResponsivePadding--footer";if(o){t.addStyleClass(l)}else{t.removeStyleClass(l)}var n=e.data("confirmButtonText");t.setConfirmButtonText(n);sap.ui.core.syncStyleClass("sapUiSizeCompact",this.getView(),t)},handleTableSelectDialogPress:function(e){},onChangeLogic:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.CalculationLogic=t},onChangeScope:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.Scope=t},onChangeSDG:function(e){var t=e.getSource().getProperty("selectedKeys").toString();console.log(t);this.SDG=t},onChangeRenon:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.RENON=t},onChangeKPI_EnergyConv:function(e){var t=e.getParameters().value;console.log(t);this.KPI=t;var s=this;var a=s.getView().byId("Sub_Type").getModel("EnergyModel");var i=a.getData().results;var r=null;for(var o=0;o<i.length;o++){if(i[o].Type===this.KPITypeSelected&&i[o].SubType===this.KPISubtypeSelected&&i[o].KPI===this.KPI){r=i[o].Measure}}s.oKPIMeasure=r;var l=[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:r})];var n=[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:"Energy"})];console.log(l);var g=s.getView().byId("cbEnergyConvIP");var u=sap.ui.getCore().getModel("EnergyListModel");var d=s.getView().byId("cbEnergyConvOP");var m=s.getView().byId("cbEnergyConvOP").getModel("EnergyListModel");this._getFilterData_EnergyConv(d,m,n)},onChangeUOMConvUsrInput:function(e){var t=e.getParameter("selectedItem").getText();console.log("selText:"+t);this.UserInputUnit=t},onChangeUOMConvExpOutput:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.ExpectedOutputUnit=t},onChangeMeasureOutput:function(e){var s=this;var a=e.getParameter("selectedItem").getText();console.log("Measure Output:"+a);this.MeasureExpectedOutputUnit=a;var i=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var r=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:a}),new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:i})],and:true});var o=this.getOwnerComponent().getModel("dataModel");var l="/UOM";this.MeasureModel=new sap.ui.model.json.JSONModel;o.read(l,{filters:[r],success:function(e,t){var a=new sap.ui.model.json.JSONModel;a.setData(e);s.MeasureModel.setData(e);console.log("ListModel:"+a);var i=e.results;var r={items:i};s.getView().getModel().setProperty("/MeasureList",i);var o=s.getView().byId("cbUOMConv2_Measure");o.bindAggregation("items","/MeasureList",new sap.ui.core.ListItem({text:"{Abbreviation}",key:"{Abbreviation}"}))},error:function(e){t.error("Error")}})},onChangeEF_Energy:function(e){var t=this;var s=e.getParameter("selectedItem").getText();var a=this.KPITypeSelected;var i=s;var r=this.EFTypeSelected;var o=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:a}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:i}),new sap.ui.model.Filter({path:"Standard",operator:sap.ui.model.FilterOperator.EQ,value1:r})]});console.log(o);var l=t.getView().byId("EmissionFactorsTbl");var n=l.getBinding("items");console.log(n);n.filter(o);t.getView().byId("EmissionFactorsTbl").setVisible(true)},onChangeEF_Energy1:function(e){var t=this;var s=e.getParameter("selectedItem").getText();this.KPISubtypeSelected=s;this._getKPIDataforNewEntry();this._getEmissionFactorData()},_getEmissionFactorData:function(){var e=this;``;var t=this.KPITypeSelected;var s=this.KPISubtypeSelected;var a=this.EFTypeSelected;var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:t}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:s}),new sap.ui.model.Filter({path:"Standard",operator:sap.ui.model.FilterOperator.EQ,value1:a})],and:true});console.log(i);if(e.getView().byId("EmissionFactorsTbl").getVisible()){var r=e.getView().byId("EmissionFactorsTbl");var o=r.getBinding("items");console.log(o);o.filter(i);e.getView().byId("EmissionFactorsTbl").getModel("EmissionFactorsModel").refresh(true)}},itemSelectHandler:function(e){var t=this.byId("myTabContainer");var s=e.getParameter("item");console.log("oItemToClose:"+s);this.getView().byId("btn3").setVisible(true);if(s.getName()==="Corporate Structure"){this.getView().byId("btn1").setVisible(false);this.getView().byId("btn2").setVisible(false)}else if(s.getName()==="Location"||s.getName()==="Circle"){this.getView().byId("btn1").setVisible(false);this.getView().byId("btn2").setVisible(false)}else if(s.getName()==="General"){this.getView().byId("btn1").setVisible(false);this.getView().byId("btn2").setVisible(false);this.getView().byId("btn3").setVisible(true)}else if(s.getName()==="Measure"){if(this.UoMTypeSelected==="Measure Types"){this.getView().byId("btn1").setVisible(false);this.getView().byId("btn2").setVisible(false)}else if(this.UoMTypeSelected==="UoM Values"){this.getView().byId("btn1").setVisible(true);this.getView().byId("btn2").setVisible(true)}}else{this.getView().byId("btn1").setVisible(true);this.getView().byId("btn2").setVisible(true)}if(s.getName()==="Emission Factors"){this.calloData_KPIList()}},itemSelectHandlerMyTab1:function(e){var t=this.byId("myTabContainer1");var s=e.getParameter("item");console.log("oItemToClose:"+s)},itemSelectHandlerMyTab2:function(e){var t=this.byId("myTabContainer2");var s=e.getParameter("item");console.log("oItemToClose:"+s);if(s.getName()==="Emission Factors"){this.calloData_KPIList()}},onSelect_Radiobutton_Energy:function(e){var t=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.EnergyTypeSelected=t;this.KPITypeSelected=t;console.log("txt:"+t);this._getFilterData_Energy()},_getFilterData_KPI_EF:function(){var e=this;var t=e.getView().byId("EF_Type").getModel("KPIModel");var s=this.KPITypeSelected;var a=[];var i=[];var r=t.getData().results;for(var o=0;o<r.length;o++){if(r[o].Type===s){for(var l=0;l<r.length;l++){if(a.indexOf(r[l].SubType)===-1&&r[l].Type===s){a.push(r[l].SubType)}}}}console.log(a);e.getView().byId("EF_Type").setSelectedKey(a[0]);this.KPISubtypeSelected=a[0];for(var o=0;o<a.length;o++){var n={};n.SubType=a[o];i.push(n)}console.log(i);e.getView().getModel().setProperty("/Countries",i);var g=e.getView().byId("EF_Type");g.bindAggregation("items","/Countries",new sap.ui.core.ListItem({text:"{SubType}",key:"{SubType}"}));this._getKPIDataforNewEntry();this._getEmissionFactorData()},_getFilterData_Energy:function(){var e=this;var t=e.getView().byId("Sub_Type").getModel("EnergyModel");var s=this.EnergyTypeSelected;var a=[];var i=[];var r=t.getData().results;for(var o=0;o<r.length;o++){if(r[o].Type===s){for(var l=0;l<r.length;l++){if(a.indexOf(r[l].SubType)===-1&&r[l].Type===s){a.push(r[l].SubType)}}}}console.log(a);e.getView().byId("Sub_Type").setSelectedKey(a[0]);this.EnergySubtypeSelected=a[0];this.KPISubtypeSelected=a[0];for(var o=0;o<a.length;o++){var n={};n.SubType=a[o];i.push(n)}console.log(i);e.getView().getModel().setProperty("/Countries",i);var g=e.getView().byId("Sub_Type");g.bindAggregation("items","/Countries",new sap.ui.core.ListItem({text:"{SubType}",key:"{SubType}"}));this._getKPIDataforNewEnergy();this._getEnergyTblData()},_getEnergyTblData:function(){var e=this;``;var t=this.KPITypeSelected;var s=this.KPISubtypeSelected;var a=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:t}),new sap.ui.model.Filter({path:"Subtype",operator:sap.ui.model.FilterOperator.EQ,value1:s})],and:true});console.log(a);var i=e.getView().byId("energyConvTbl");var r=i.getBinding("items");r.filter([]);console.log(r);r.filter(a);e.getView().byId("energyConvTbl").getModel().refresh(true)},handleLoadItems:function(e){},_getFilterData_EnergyConv:function(e,t,s){let a=[];var i=this;let r=new sap.ui.model.json.JSONModel;for(let e=0;e<t.oData.results.length;e++){if(t.oData.results[e].Measure===i.oKPIMeasure){console.log(""+t.oData.results[e].Abbreviation);a.push(t.oData.results[e])}}i.getView().byId("cbEnergyConvIP").getModel("FilterEnergy").setData({results:a});console.log("oFilteredObjects:"+a)},_getKPIDataforNewEnergy:function(){var e=this;var t=e.getView().byId("Sub_Type").getModel("EnergyModel");var s=this.KPITypeSelected;var a=this.KPISubtypeSelected;var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:s}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:a})],and:true});console.log(i);var r=new sap.ui.core.ListItem({key:"{EnergyModel>KPI}",text:"{EnergyModel>KPI}"});var o=e.getView().byId("KPI_Energy");o.bindAggregation("items",{path:"EnergyModel>/results",template:r,filters:i})},onChange_Energy:function(e){var t=this;var s=e.getParameter("selectedItem").getText();this.KPISubtypeSelected=s;this._getKPIDataforNewEnergy();this._getEnergyTblData()},onSelect_Radiobutton_EF:function(e){var t=this;var s=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.KPITypeSelected=s;console.log("txt:"+s);this._getFilterData_KPI_EF()},_getKPIDataforNewEntry:function(){var e=this;var t=e.getView().byId("EF_Type").getModel("KPIModel");var s=this.KPITypeSelected;var a=this.KPISubtypeSelected;var i=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:s}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:a})],and:true});console.log(i);var r=new sap.ui.core.ListItem({key:"{KPIModel>KPI}",text:"{KPIModel>KPI}"});var o=e.getView().byId("KPI");o.bindAggregation("items",{path:"KPIModel>/results",template:r,filters:i})},handleExcel_Template:function(e){window.open("./documents/Template1.csv")},handleSortButtonPressed:function(){this.getViewSettingsDialog("com.techm.sustainabilityui.fragment.SortDialog").then(function(e){e.open()})},getViewSettingsDialog:function(e){var t=this._mViewSettingsDialogs[e];if(!t){t=s.load({id:this.getView().getId(),name:e,controller:this});this._mViewSettingsDialogs[e]=t}return t},onSearch:function(e){var t=[];var s=e.getParameter("query");if(s){t.push(new i("Type",a.Contains,s))}var r=this.getView().byId("tableId");var o=r.getBinding("items");o.filter(t)},formatEditField:function(e,t,s){if(e||t){return true}else if(s){return false}},formatDisplayField:function(e,t,s){if(e||t){return false}else if(s){return true}},formatPKeyField:function(e,t,s){if(e){return false}else if(s||t){return true}},onSelect_Radiobutton_PrefixTypes:function(e){var t=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.PrefixTypesSelected=t;if(t==="Prefix Types"){this.getView().byId("prefixTypesTbl").setVisible(true);this.getView().byId("prefixTypes").setVisible(true);this.getView().byId("prefixValues").setVisible(false)}else if(t==="Prefix Values"){this.getView().byId("prefixTypesTbl").setVisible(false);this.getView().byId("prefixTypes").setVisible(false);this.getView().byId("prefixValues").setVisible(true)}},onSelect_Radiobutton_General:function(e){var t=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.UoMTypeSelected=t;if(t==="Measure Types"){this.getView().byId("generalTbl").setVisible(true);this.getView().byId("meaType").setVisible(true);this.getView().byId("uomValues").setVisible(false);this.getView().byId("btn1").setVisible(false);this.getView().byId("btn2").setVisible(false)}else if(t==="UoM Values"){this.getView().byId("generalTbl").setVisible(false);this.getView().byId("meaType").setVisible(false);this.getView().byId("uomValues").setVisible(true);this.getView().byId("btn1").setVisible(true);this.getView().byId("btn2").setVisible(true)}},onSelect_Radiobutton_Year:function(e){var t=this;this.getView().byId("generalTbl").setVisible(false);this.getView().byId("yearRBtn").setVisible(true);this.getView().byId("yearAlign").setVisible(true);this.getView().byId("generalYearTblAlign").setVisible(true);this.getView().byId("generalYearTbl").setVisible(true);var s=t.getView().byId("generalYearTbl").getItems();var a=t.getView().byId("generalYearTbl").getItems().length-1;var i=this.getView().byId("generalYearTbl").getModel("yearModel");var r=this.GlobalIndustryModel.getData().Industry;var o=[new sap.ui.model.Filter({path:"Vertical",operator:sap.ui.model.FilterOperator.EQ,value1:r})];var l=t.getView().byId("generalYearTbl");var n=l.getBinding("items");n.filter(o);console.log(n);for(var g=0;g<i.getData().results.length;g++){if(i.getData().results[g].isExistingRow){var u=s[g].mAggregations.cells[0].mAggregations.items[1].mProperties.value;console.log("val:"+u)}}},callBindings:function(){var e=this;var t=e.getView().byId("firstTabl",{columns:[new sap.ui.table.Column({label:"Description",template:"Description"}),new sap.ui.table.Column({label:"NodeID",template:"id"}),new sap.ui.table.Column({label:"ParentNodeID",template:"ParentNodeID"})],selectionMode:sap.ui.table.SelectionMode.Single,enableColumnReordering:true});var s=this.getOwnerComponent().getModel("dataModel");t.setModel(s);t.bindRows({path:"/Standards_Module",parameters:{expand:"toStandards_Module",navigation:{Standards_Module:"toStandards_Module"},countMode:"Inline",treeAnnotationProperties:{hierarchyLevelFor:"HierarchyLevel",hierarchyNodeFor:"id",hierarchyParentNodeFor:"ParentNodeID",hierarchyDrillStateFor:"DrillState"}}})},onExportExcelMeasures:function(e){this._importMeasures(e.getParameter("files")&&e.getParameter("files")[0])},_importMeasures:function(e){var t=this;var s={};this.MeasureModel=new sap.ui.model.json.JSONModel;if(e&&window.FileReader){var a=new FileReader;a.onload=function(e){var a=e.target.result;var i=XLSX.read(a,{type:"binary"});i.SheetNames.forEach(function(e){s=XLSX.utils.sheet_to_row_object_array(i.Sheets[e])});t.MeasureModel.setData(s);t.MeasureModel.refresh(true);console.log("measure model:"+t.MeasureModel);if(t.MeasureModel.getData().length>0){for(var r=0;r<t.MeasureModel.getData().length;r++){var o={MeasureType:t.MeasureModel.getData()[r].MeasureType,InputUom:t.MeasureModel.getData()[r].InputUom,OutputUoM:t.MeasureModel.getData()[r].ExpectedUoM};t.calloData_MeasureValidation(o);console.log("data:"+t.MeasureModel.getData()[r]);sap.m.MessageToast.show("The details submitted Successfully!!!")}}};a.onerror=function(e){console.log(e)};a.readAsBinaryString(e)}},calloData_MeasureValidation:function(e){var t=this;this.batchChanges=[];this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchModel.setUseBatch(true);var s=this.getOwnerComponent().getModel("dataModel");s.create("/Measure_Validation",e,null,function(){sap.m.MessageBox.show("Success!!")},function(){alert("Create failed")})},handleDownloadExcel:function(e){window.open("./documents/Measures.xlsx")},handleSelectionFinish_PrefixKPI:function(e){this.socialPrefix="";var t=e.getParameter("selectedItems");var s="";for(var a=0;a<t.length;a++){s+=t[a].getText();if(a!=t.length-1){s+=","}}sap.m.MessageToast.show("test:"+s);this.socialPrefix=s},parseBool:function(e){},onPressSearch:function(e){this._callTemplate1()},_callTemplate1:function(){var e=this;this.EnvModel=new sap.ui.model.json.JSONModel;var t=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Division",operator:sap.ui.model.FilterOperator.EQ,value1:"Bharti Airtel Limited"}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()}),new sap.ui.model.Filter({path:"fiscal",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"NETWORK TRAFFIC"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:"Voice & Data Traffic"}),new sap.ui.model.Filter({path:"KPI",operator:sap.ui.model.FilterOperator.EQ,value1:"3G Data Traffic"})],and:true});e.total=0;var s=this.getOwnerComponent().getModel("dataModel");var a="/Environment_Report_Telecom";e.valArray=[];s.read(a,{filters:[t],success:function(t,s){var a=new sap.ui.model.json.JSONModel;a.setData(t);e.EnvModel.setData(t);var i=t.results.length;console.log("msg length:"+i);for(var r=0;r<i;r++){e.valArray.push(e.EnvModel.getData().results[r].Value);e.total+=parseInt(e.EnvModel.getData().results[r].Value)}console.log("value:-"+e.valArray);console.log("total:-"+e.total)},error:function(e){}})},handlePrint:function(e){var t=this;this.getView().byId("myText");console.log("msg");var s=this.getView().byId("tblDivision");var a=s.getBinding("items");console.log("msg:"+a);var i=a.oList.length;var r=[];for(let e=0;e<i;e++){r.push(a.oList[e].Division)}console.log("div:"+r);var o=new sap.ui.model.json.JSONModel({HTML:"<h3>subheader</h3>"+'<p>link: <a href="//www.sap.com" style="color:green; font-weight:600;">link to sap.com</a> - links open in a new window.</p>'+r+"<p>paragraph: <strong>strong</strong> and <em>emphasized</em>.</p>"+"<p>list:</p>"+t.valArray+"<p>Total:</p>"+t.total+"<ul><li>list item 1</li><li>list item 2<ul><li>sub item 1</li><li>sub item 2</li></ul></li></ul>"+"<p>pre:</p><pre>abc    def    ghi</pre>"+'<p>code: <code>var el = document.getElementById("myId");</code></p>'+"<p>cite: <cite>a reference to a source</cite></p>"+"<dl><dt>definition:</dt><dd>definition list of terms and descriptions</dd>"+"<p>Lorem ipsum dolor sit amet"+"consectetur adipiscing elit. Suspendisse ornare, nibh nec gravida tincidunt, ipsum quam venenatis nisl, vitae venenatis urna sem eget ipsum. Ut cursus auctor leo et vulputate."+"Curabitur nec pretium odio, sed auctor felis. In vehicula, eros aliquam pharetra mattis, ante mi fermentum massa, nec pharetra arcu massa finibus augue.</p> "+'<p><img style="float: left; padding-right: 1em;" src="http://monliban.org/images/1473838236_274706_l_srgb_s_gl_465881_large.jpg" width="304" height="181">'+'<span style="font-size: 10.5pt; font-family: sans-serif; color: #0070c0;">Phasellus imperdiet metus est, in luctus erat fringilla ut. In commodo magna justo, sit amet ultrices ipsum egestas quis.</span><span style="font-size: 10.5pt; font-family: sans-serif; color: black;"> '+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. <strong>Aenean quam libero</strong>, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. <strong><em>Aliquam semper neque eu aliquam dictum</em></strong>. "+"Nulla in convallis diam. Fusce molestie risus nec posuere ullamcorper. Fusce ut sodales tortor. <u>Morbi eget odio a augue viverra semper.</u></span></p>"+"<p><span>Fusce dapibus sodales ornare. "+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. Aenean quam libero, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. Nullam laoreet metus ac enim placerat, nec tempor arcu finibus. "+"Curabitur nec pretium odio, sed auctor felis. Nam eu neque faucibus, pharetra purus id, congue elit. Phasellus neque lectus, gravida at cursus at, pretium eu lorem. </span></p>"+"<ul>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Nulla non elit hendrerit, auctor arcu sit amet, tempor nisl.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Morbi sed libero pulvinar, maximus orci et, hendrerit orci.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Phasellus sodales enim nec sapien commodo mattis.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Integer laoreet eros placerat pharetra euismod.</span></li>'+"</ul>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #c00000;">Ut vitae commodo ante. Morbi nibh dolor, ullamcorper sed interdum id, molestie vel libero. '+"Proin volutpat dui eget ipsum scelerisque, a ullamcorper ipsum mattis. Cras sed elit sit amet diam convallis vehicula vitae ut nisl. Ut ornare dui ligula, id euismod lectus eleifend at. Nulla facilisi. In pharetra lectus et augue consequat vestibulum.</span></p>"+"<ol>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Proin id eros vel libero maximus dignissim ac et velit.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">In non odio pharetra, dapibus augue quis, laoreet felis.</span></li>'+"</ol>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Donec a consectetur libero. Donec ut massa justo. Duis euismod varius odio in rhoncus. Nullam sagittis enim vel massa tempor, '+"ut malesuada libero mollis. Vivamus dictum diam diam, quis rhoncus ex congue vel.</span></p>"+'<p style="text-align: center; font-size: 10pt; font-family: Calibri, sans-serif;" ><em><span style="font-family: sans-serif; color: #a6a6a6;">Neque porro quisquam est qui dolorem ipsum quia dolor sit amet consectetur adipisci velit</span></em></p>'+'<p style="text-align: right; font-size: 10pt; font-family: Calibri, sans-serif;" ><span style="font-family: sans-serif; color: #353535;">-</span> <strong><span style="font-family: sans-serif; color: #353535;">Sed in lacus dolor.</span></strong></p>'+"<p>paragraph: <strong>strong</strong> and <em>emphasized</em>.</p>"+"<p>list:</p>"+"<ul><li>list item 1</li><li>list item 2<ul><li>sub item 1</li><li>sub item 2</li></ul></li></ul>"+"<p>pre:</p><pre>abc    def    ghi</pre>"+'<p>code: <code>var el = document.getElementById("myId");</code></p>'+"<p>cite: <cite>a reference to a source</cite></p>"+"<dl><dt>definition:</dt><dd>definition list of terms and descriptions</dd>"+"<p>Lorem ipsum dolor sit amet"+"consectetur adipiscing elit. Suspendisse ornare, nibh nec gravida tincidunt, ipsum quam venenatis nisl, vitae venenatis urna sem eget ipsum. Ut cursus auctor leo et vulputate."+"Curabitur nec pretium odio, sed auctor felis. In vehicula, eros aliquam pharetra mattis, ante mi fermentum massa, nec pharetra arcu massa finibus augue.</p> "+'<p><img style="float: left; padding-right: 1em;" src="http://monliban.org/images/1473838236_274706_l_srgb_s_gl_465881_large.jpg" width="304" height="181">'+'<span style="font-size: 10.5pt; font-family: sans-serif; color: #0070c0;">Phasellus imperdiet metus est, in luctus erat fringilla ut. In commodo magna justo, sit amet ultrices ipsum egestas quis.</span><span style="font-size: 10.5pt; font-family: sans-serif; color: black;"> '+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. <strong>Aenean quam libero</strong>, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. <strong><em>Aliquam semper neque eu aliquam dictum</em></strong>. "+"Nulla in convallis diam. Fusce molestie risus nec posuere ullamcorper. Fusce ut sodales tortor. <u>Morbi eget odio a augue viverra semper.</u></span></p>"+"<p><span>Fusce dapibus sodales ornare. "+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. Aenean quam libero, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. Nullam laoreet metus ac enim placerat, nec tempor arcu finibus. "+"Curabitur nec pretium odio, sed auctor felis. Nam eu neque faucibus, pharetra purus id, congue elit. Phasellus neque lectus, gravida at cursus at, pretium eu lorem. </span></p>"+"<ul>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Nulla non elit hendrerit, auctor arcu sit amet, tempor nisl.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Morbi sed libero pulvinar, maximus orci et, hendrerit orci.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Phasellus sodales enim nec sapien commodo mattis.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Integer laoreet eros placerat pharetra euismod.</span></li>'+"</ul>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #c00000;">Ut vitae commodo ante. Morbi nibh dolor, ullamcorper sed interdum id, molestie vel libero. '+"Proin volutpat dui eget ipsum scelerisque, a ullamcorper ipsum mattis. Cras sed elit sit amet diam convallis vehicula vitae ut nisl. Ut ornare dui ligula, id euismod lectus eleifend at. Nulla facilisi. In pharetra lectus et augue consequat vestibulum.</span></p>"+"<ol>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Proin id eros vel libero maximus dignissim ac et velit.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">In non odio pharetra, dapibus augue quis, laoreet felis.</span></li>'+"</ol>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Donec a consectetur libero. Donec ut massa justo. Duis euismod varius odio in rhoncus. Nullam sagittis enim vel massa tempor, '+"ut malesuada libero mollis. Vivamus dictum diam diam, quis rhoncus ex congue vel.</span></p>"+'<p style="text-align: center; font-size: 10pt; font-family: Calibri, sans-serif;" ><em><span style="font-family: sans-serif; color: #a6a6a6;">Neque porro quisquam est qui dolorem ipsum quia dolor sit amet consectetur adipisci velit</span></em></p>'+'<p style="text-align: right; font-size: 10pt; font-family: Calibri, sans-serif;" ><span style="font-family: sans-serif; color: #353535;">-</span> <strong><span style="font-family: sans-serif; color: #353535;">Sed in lacus dolor.</span></strong></p>'+"<p>paragraph: <strong>strong</strong> and <em>emphasized</em>.</p>"+"<p>list:</p>"+"<ul><li>list item 1</li><li>list item 2<ul><li>sub item 1</li><li>sub item 2</li></ul></li></ul>"+"<p>pre:</p><pre>abc    def    ghi</pre>"+'<p>code: <code>var el = document.getElementById("myId");</code></p>'+"<p>cite: <cite>a reference to a source</cite></p>"+"<dl><dt>definition:</dt><dd>definition list of terms and descriptions</dd>"+"<p>Lorem ipsum dolor sit amet"+"consectetur adipiscing elit. Suspendisse ornare, nibh nec gravida tincidunt, ipsum quam venenatis nisl, vitae venenatis urna sem eget ipsum. Ut cursus auctor leo et vulputate."+"Curabitur nec pretium odio, sed auctor felis. In vehicula, eros aliquam pharetra mattis, ante mi fermentum massa, nec pharetra arcu massa finibus augue.</p> "+'<p><img style="float: left; padding-right: 1em;" src="http://monliban.org/images/1473838236_274706_l_srgb_s_gl_465881_large.jpg" width="304" height="181">'+'<span style="font-size: 10.5pt; font-family: sans-serif; color: #0070c0;">Phasellus imperdiet metus est, in luctus erat fringilla ut. In commodo magna justo, sit amet ultrices ipsum egestas quis.</span><span style="font-size: 10.5pt; font-family: sans-serif; color: black;"> '+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. <strong>Aenean quam libero</strong>, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. <strong><em>Aliquam semper neque eu aliquam dictum</em></strong>. "+"Nulla in convallis diam. Fusce molestie risus nec posuere ullamcorper. Fusce ut sodales tortor. <u>Morbi eget odio a augue viverra semper.</u></span></p>"+"<p><span>Fusce dapibus sodales ornare. "+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. Aenean quam libero, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. Nullam laoreet metus ac enim placerat, nec tempor arcu finibus. "+"Curabitur nec pretium odio, sed auctor felis. Nam eu neque faucibus, pharetra purus id, congue elit. Phasellus neque lectus, gravida at cursus at, pretium eu lorem. </span></p>"+"<ul>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Nulla non elit hendrerit, auctor arcu sit amet, tempor nisl.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Morbi sed libero pulvinar, maximus orci et, hendrerit orci.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Phasellus sodales enim nec sapien commodo mattis.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Integer laoreet eros placerat pharetra euismod.</span></li>'+"</ul>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #c00000;">Ut vitae commodo ante. Morbi nibh dolor, ullamcorper sed interdum id, molestie vel libero. '+"Proin volutpat dui eget ipsum scelerisque, a ullamcorper ipsum mattis. Cras sed elit sit amet diam convallis vehicula vitae ut nisl. Ut ornare dui ligula, id euismod lectus eleifend at. Nulla facilisi. In pharetra lectus et augue consequat vestibulum.</span></p>"+"<ol>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Proin id eros vel libero maximus dignissim ac et velit.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">In non odio pharetra, dapibus augue quis, laoreet felis.</span></li>'+"</ol>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Donec a consectetur libero. Donec ut massa justo. Duis euismod varius odio in rhoncus. Nullam sagittis enim vel massa tempor, '+"ut malesuada libero mollis. Vivamus dictum diam diam, quis rhoncus ex congue vel.</span></p>"+'<p style="text-align: center; font-size: 10pt; font-family: Calibri, sans-serif;" ><em><span style="font-family: sans-serif; color: #a6a6a6;">Neque porro quisquam est qui dolorem ipsum quia dolor sit amet consectetur adipisci velit</span></em></p>'+'<p style="text-align: right; font-size: 10pt; font-family: Calibri, sans-serif;" ><span style="font-family: sans-serif; color: #353535;">-</span> <strong><span style="font-family: sans-serif; color: #353535;">Sed in lacus dolor.</span></strong></p>'});this.getView().setModel(o);var l=$.sap.getModulePath("print","/image/");var n=l+this.getView().byId("myText").getHtmlText();var g=window.open("","prntExample");g.document.write(n);setTimeout(function(){g.print();g.close()},1e3)},initRichTextEditor:function(e){var t=this,s='<p style="text-align: justify; background: white; font-size: 10pt; font-family: Calibri, sans-serif;"><strong><span style="font-size: 10.5pt; font-family: sans-serif; color: black;">Lorem ipsum dolor sit amet</span></strong>'+'<span style="font-size: 10.5pt; font-family: sans-serif; color: black;">, consectetur adipiscing elit. Suspendisse ornare, nibh nec gravida tincidunt, ipsum quam venenatis nisl, vitae venenatis urna sem eget ipsum. Ut cursus auctor leo et vulputate. '+"Curabitur nec pretium odio, sed auctor felis. In vehicula, eros aliquam pharetra mattis, ante mi fermentum massa, nec pharetra arcu massa finibus augue. </span></p> "+'<p style="margin: 0in 0in 11.25pt; text-align: justify; background: white; font-size: 10pt; font-family: Calibri, sans-serif;"><img style="float: left; padding-right: 1em;" src="http://monliban.org/images/1473838236_274706_l_srgb_s_gl_465881_large.jpg" width="304" height="181">'+'<span style="font-size: 10.5pt; font-family: sans-serif; color: #0070c0;">Phasellus imperdiet metus est, in luctus erat fringilla ut. In commodo magna justo, sit amet ultrices ipsum egestas quis.</span><span style="font-size: 10.5pt; font-family: sans-serif; color: black;"> '+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. <strong>Aenean quam libero</strong>, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. <strong><em>Aliquam semper neque eu aliquam dictum</em></strong>. "+"Nulla in convallis diam. Fusce molestie risus nec posuere ullamcorper. Fusce ut sodales tortor. <u>Morbi eget odio a augue viverra semper.</u></span></p>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Fusce dapibus sodales ornare. '+"Nullam ac mauris felis. Sed tempor odio diam, nec ullamcorper lacus laoreet vitae. Aenean quam libero, varius eu ex eu, aliquet fermentum orci. Donec eget ante sed enim pretium tempus. Nullam laoreet metus ac enim placerat, nec tempor arcu finibus. "+"Curabitur nec pretium odio, sed auctor felis. Nam eu neque faucibus, pharetra purus id, congue elit. Phasellus neque lectus, gravida at cursus at, pretium eu lorem. </span></p>"+"<ul>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Nulla non elit hendrerit, auctor arcu sit amet, tempor nisl.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Morbi sed libero pulvinar, maximus orci et, hendrerit orci.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Phasellus sodales enim nec sapien commodo mattis.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Integer laoreet eros placerat pharetra euismod.</span></li>'+"</ul>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #c00000;">Ut vitae commodo ante. Morbi nibh dolor, ullamcorper sed interdum id, molestie vel libero. '+"Proin volutpat dui eget ipsum scelerisque, a ullamcorper ipsum mattis. Cras sed elit sit amet diam convallis vehicula vitae ut nisl. Ut ornare dui ligula, id euismod lectus eleifend at. Nulla facilisi. In pharetra lectus et augue consequat vestibulum.</span></p>"+"<ol>"+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Proin id eros vel libero maximus dignissim ac et velit.</span></li>'+'<li style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">In non odio pharetra, dapibus augue quis, laoreet felis.</span></li>'+"</ol>"+'<p style="font-size: 10pt; font-family: Calibri, sans-serif;"><span style="font-family: sans-serif; color: #353535;">Donec a consectetur libero. Donec ut massa justo. Duis euismod varius odio in rhoncus. Nullam sagittis enim vel massa tempor, '+"ut malesuada libero mollis. Vivamus dictum diam diam, quis rhoncus ex congue vel.</span></p>"+'<p style="text-align: center; font-size: 10pt; font-family: Calibri, sans-serif;" align="center"><em><span style="font-family: sans-serif; color: #a6a6a6;">"Neque porro quisquam est qui dolorem ipsum quia dolor sit amet, consectetur, adipisci velit..."</span></em></p>'+'<p style="text-align: right; font-size: 10pt; font-family: Calibri, sans-serif;" align="right"><span style="font-family: sans-serif; color: #353535;">-</span> <strong><span style="font-family: sans-serif; color: #353535;">Sed in lacus dolor.</span></strong></p>';sap.ui.require(["sap/ui/richtexteditor/RichTextEditor","sap/ui/richtexteditor/library"],function(a,i){var r=i.EditorType;t.oRichTextEditor=new a("myRTE",{editorType:e?r.TinyMCE5:r.TinyMCE6,width:"100%",height:"600px",customToolbar:true,showGroupFont:true,showGroupLink:true,showGroupInsert:true,value:s,ready:function(){e?this.addButtonGroup("styleselect").addButtonGroup("table"):this.addButtonGroup("styles").addButtonGroup("table")}})})}})});
//# sourceMappingURL=Admin.controller.js.map