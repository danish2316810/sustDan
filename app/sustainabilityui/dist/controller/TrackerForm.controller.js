sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox"],function(e){"use strict";return e.extend("com.techm.sustainabilityui.controller.TrackerForm",{onInit:function(){that=this;let e=sap.ui.core.UIComponent.getRouterFor(this);let t=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("box0").setModel(t,"divisionModel");let o=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("box1").setModel(o,"locationModel");let a=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("box2").setModel(a,"yearModel");let i=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("directUnit").setModel(i,"directUnit");let r=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("inDirectUnit").setModel(r,"inDirectUnit");let l=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("waterUnit").setModel(l,"waterUnit");this.getView().byId("waterUnit1").setModel(l,"waterUnit");this.getView().byId("waterRecycleUnit").setModel(l,"waterUnit");let s=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("emissionUnit2").setModel(s,"emissionUnit");this.getView().byId("materialUnit").setModel(s,"emissionUnit");let n=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().setModel(n,"viewModel");let d=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("deOptions").setModel(d,"DEOptionsModel");let p=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("ideOptions").setModel(p,"IDEOptionsModel");let u=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("waterOptions").setModel(u,"WaterOptionsModel");let c=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("wasteOptions").setModel(c,"WasteOptionsModel");let m=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("commuteOptions").setModel(m,"CommuteModel");let g=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("personalCommuteOptions").setModel(g,"PersonalCommuteModel");let y=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("businessTravelOptions").setModel(y,"BusinessTravelModel");let w=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("upstreamTravelOptions").setModel(w,"UpstreamTransModel");let b=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().byId("wfhOptions").setModel(b,"RemoteModel");let h=new sap.ui.model.json.JSONModel("model/mock.json");this.getView().setModel(h,"unitModel");this.onPressGo(event);this.onUpdateFValue()},setTimeout:function(){var e=this.getView().byId("imgcar");setTimeout(function(){e.next()},2500)},callODataService:function(){var e=this;var t=new sap.m.BusyDialog({});t.open();var o=this.getOwnerComponent().getModel("dataModel");o.read("/Direct_Energy",{success:function(o,a){t.close();var i=new sap.ui.model.json.JSONModel;i.setData(o);e.getView().byId("sustain").setModel(i)},error:function(e){t.close()}})},onPressGo:function(e){var t=this;t.getView().byId("CS").setVisible(true);this.getView().byId("btn1").setVisible(true);this.getView().byId("btn2").setVisible(true);this.getView().byId("btn3").setVisible(true);var o=new sap.m.BusyDialog({});o.open();var a=this.getOwnerComponent().getModel("dataModel");a.read("/Sustainability_Report_Temp",{success:function(e,a){o.close();var i=new sap.ui.model.json.JSONModel;i.setData(e);t.getView().byId("directEnergy").setModel(i);t.getView().byId("waterTbl").setModel(i);t.getView().byId("waterTbl1").setModel(i);t.getView().byId("inDirectEnergyTbl").setModel(i);t.getView().byId("wasteTbl").setModel(i);t.getView().byId("recycleTbl").setModel(i);t.getView().byId("materialTbl").setModel(i);t.getView().byId("commuteTbl").setModel(i);t.getView().byId("personalTbl").setModel(i);t.getView().byId("businessTbl").setModel(i);t.getView().byId("upstreamTbl").setModel(i);t.getView().byId("wfhTbl").setModel(i);t.onSelectionOfYear()},error:function(e){o.close()}})},onPressSubmit:function(e){var t={ReportType:"DirectEnergy"};var o={definitionId:"reportapprovalwf",context:t};$.ajax({url:"/comtechmsustainabilityui/bpmworkflowruntime/v1/xsrf-token",method:"GET",headers:{"X-CSRF-Token":"Fetch"},success:function(e,t,a){var i=a.getResponseHeader("X-CSRF-Token");if(i===null)return;$.ajax({url:"/comtechmsustainabilityui/bpmworkflowruntime/v1/workflow-instances",type:"POST",data:JSON.stringify(o),headers:{"X-CSRF-Token":i,"Content-Type":"application/json"},async:false,success:function(e){MessageBox.information("The Records successfully submitted for approval")},error:function(e){}})}})},onUpdateFValue:function(){var e=new sap.ui.model.json.JSONModel;var t=this.getOwnerComponent().getModel("dataModel");t.read("/Environment_Report_Temp",{success:function(o,a){e.setData(o);console.log(e);for(var i=0;i<o.results.length;i++){if(o.results[i].KPI==="Refrigerant (R32)"){var r={Year:o.results[i].Year,Month:o.results[i].Month,Location:o.results[i].Location,Type:o.results[i].Type,SubType:o.results[i].SubType,KPI:o.results[i].KPI,Value:parseFloat(o.results[i].Value),Unit:o.results[i].Unit,Cost:o.results[i].Cost,Currency:o.results[i].Currency,Quality:o.results[i].Quality,Comment:o.results[i].Comment,Owner:o.results[i].Owner,Approver:o.results[i].Approver,Division:o.results[i].Division,Value2:o.results[i].Value2,Unit2:o.results[i].Unit2,Distance:o.results[i].Distance,Weight:o.results[i].Weight,Scope:o.results[i].Scope,Associates:o.results[i].Associates,Sno:o.results[i].Sno,Date:o.results[i].Date,FValue:0};console.log(i);console.log(r);t.create("/Environment_Report",r,null,function(){sap.m.MessageToast.show("The details submitted Successfully!!!");console.log("created record")},function(){alert("Create failed")})}}},error:function(e){}})},onPressSubmit_V1:function(e){var t=this;var o={Year:t.getView().byId("box2").getSelectedKey(),Month:t.getView().byId("directEnergy").getItems()[0].getCells()[0].mProperties.title,Value:t.getView().byId("directEnergy").getItems()[0].getCells()[1].mProperties.value,Unit:"gl",Cost:t.getView().byId("directEnergy").getItems()[0].getCells()[3].mProperties.value,Currency:"USD",Quality:"OK",Comment:"NA",Type:"Direct Energy",SubType:t.getView().byId("deOptions").getSelectedKey(),Owner:t.getView().byId("directEnergy").getItems()[0].getCells()[7].mProperties.text,Approver:t.getView().byId("directEnergy").getItems()[0].getCells()[8].mProperties.text,Division:t.getView().byId("box0").getSelectedKey(),Location:t.getView().byId("box1").getSelectedKey(),Value2:null,Unit2:null,Distance:null,Weight:null,Associates:null,Sno:null,Date:null,FValue:null};console.log("jsonSustain:"+o);var a=this.getOwnerComponent().getModel("dataModel");a.create("/Environment_Report",o,null,function(){sap.m.MessageToast.show("The details submitted Successfully!!!")},function(){alert("Create failed")})},pageChanged:function(){setTimeout(function(){carousel.next()},2500)},handleDownloadPress:function(e){this.selectedTableRow=e.getSource().getBindingContext().getObject();window.open("./documents/DirectEnergy.pdf")},handleDownloadPress_Indirect:function(e){this.selectedTableRow=e.getSource().getBindingContext().getObject();window.open("./documents/InDirectEnergy.pdf")},handleDownloadPress_Water:function(e){this.selectedTableRow=e.getSource().getBindingContext().getObject();window.open("./documents/Water.pdf")},handleDownloadPress_Emission:function(e){this.selectedTableRow=e.getSource().getBindingContext().getObject();window.open("./documents/Emission.pdf")},handleDownloadExcel:function(e){window.open("./documents/Sustainability_Report_1.csv")},handleConnectToLocalSystem:function(e){sap.m.MessageToast.show("Pls share your system Details! We will load data for you.!!")},myFormatter:function(e){return e!==null},myFormatter1:function(e){return e===""||e===null},handleFileUploadAllowed:function(e){sap.m.MessageToast.show("The file got uploaded Successfully!!")},handleTableRowPress:function(e){sap.m.MessageToast.show("table row: "+e.getSource().getBindingContext().getObject())},handleEditBtn:function(e){var t=this;t.getOwnerComponent().getRouter().navTo("Launchpad",{},true)},onPressBack:function(e){this.getOwnerComponent().getRouter().navTo("Launchpad",{},true)},onSelectionOFDirectEnergy:function(e){var t=this;var o=t.getView().byId("directEnergy");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Direct Energy"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("deOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOFInDirectEnergy:function(e){var t=this;var o=t.getView().byId("inDirectEnergyTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"InDirectEnergy"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("ideOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfWaterWithdrawal:function(e){var t=this;var o=t.getView().byId("waterTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Water Withdrawal"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("waterOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfWaterDischarge:function(e){var t=this;var o=t.getView().byId("waterTbl1");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Water discharge"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("waterDischargeOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfWaste:function(e){var t=this;var o=t.getView().byId("wasteTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Waste"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("wasteOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfCommute:function(e){var t=this;var o=t.getView().byId("commuteTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Commute"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("commuteOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfPersonalCommute:function(e){var t=this;var o=t.getView().byId("personalTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Personal Commute"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("personalCommuteOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfBusinessTravel:function(e){var t=this;var o=t.getView().byId("businessTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Business Travel"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("businessTravelOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfUpstreamTrans:function(e){var t=this;var o=t.getView().byId("upstreamTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Upstream Transportation"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("upstreamTravelOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfRemoteWorking:function(e){var t=this;var o=t.getView().byId("wfhTbl");var a=o.getBinding("items");a.filter([]);var i=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Remote Working"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("wfhOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()})];a.filter(i)},onSelectionOfYear:function(){var e=this;var t=e.getView().byId("materialTbl");var o=t.getBinding("items");o.filter([]);var a=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Materials"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:"Paper"}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];o.filter(a);var i=e.getView().byId("wasteTbl");var r=i.getBinding("items");r.filter([]);var l=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Waste"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("wasteOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];r.filter(l);var s=e.getView().byId("waterTbl");var n=s.getBinding("items");n.filter([]);var d=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Water Withdrawal"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("waterOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];n.filter(d);var p=e.getView().byId("recycleTbl");var u=p.getBinding("items");u.filter([]);var c=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Recycled Water"}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];u.filter(c);var m=e.getView().byId("waterTbl1");var g=m.getBinding("items");g.filter([]);var y=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Water Discharged"}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];g.filter(y);var w=e.getView().byId("directEnergy");var b=w.getBinding("items");b.filter([]);var h=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Direct Energy"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("deOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];b.filter(h);var v=e.getView().byId("inDirectEnergyTbl");var F=v.getBinding("items");F.filter([]);var f=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"InDirectEnergy"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("ideOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];F.filter(f);var I=e.getView().byId("commuteTbl");var O=I.getBinding("items");O.filter([]);var S=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Commute"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("commuteOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];O.filter(S);var V=e.getView().byId("personalTbl");var T=V.getBinding("items");T.filter([]);var E=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Personal Commute"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("personalCommuteOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];T.filter(E);var M=e.getView().byId("businessTbl");var Q=M.getBinding("items");Q.filter([]);var x=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Business Travel"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("businessTravelOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];Q.filter(x);var D=e.getView().byId("upstreamTbl");var K=D.getBinding("items");K.filter([]);var j=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Upstream Transportation"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("upstreamTravelOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];K.filter(j);var C=e.getView().byId("wfhTbl");var U=C.getBinding("items");U.filter([]);var N=[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:"Remote Working"}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("wfhOptions").getSelectedKey()}),new sap.ui.model.Filter({path:"Year",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()})];U.filter(N)},onDivisionSelectionChange:function(e){},handleUploadPress:function(){var e=new sap.m.BusyDialog({title:"UploadFile",text:"Uploading ......"});e.open();var t=this;var o=this.getView().byId("fileUploader");var a=o.getFocusDomRef();var i=a.files[0];var r={clientId:"default",documentType:"custom",enrichment:{},schemaId:"6b544b34-263d-4e23-9fe4-53be6e58b54b",templateId:"a64e9813-0a4b-4e00-9d37-14ad232dd7ba"};var l=new FormData;l.append("file",i);l.append("options",'{"clientId": "default","documentType": "invoice","enrichment": {},"schemaId": "6b544b34-263d-4e23-9fe4-53be6e58b54b","templateId": "a64e9813-0a4b-4e00-9d37-14ad232dd7ba"}');console.log(r);var s="/comtechmsustainabilityui/DocExtractor/document-information-extraction/v1/document/jobs";jQuery.ajax({url:"https://3c0603actrial.authentication.us10.hana.ondemand.com/oauth/token?grant_type=client_credentials",method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic c2ItZGQ2MmE5YzAtZTYzZS00ZTgwLTg4MTQtYjM4OGVlMDIzYzE3IWIxMTA4Mzd8ZG94LXhzdWFhLXN0ZC10cmlhbCFiMTA4NDQ6Y2RkMjM0NmUtNjRiMy00NTAwLThiNTgtMDJlNDNiY2Q5ZmJmJHh1Rng1MFNuYm1qcjY1cnJuU1FlVlc4VDVQUnpWY1kwQTk3aEhXRm1DaVk9"},success:function(t,o,a){console.log("Success",t);var i="Bearer "+t.access_token;var r=jQuery.ajax({url:s,method:"POST",timeout:0,headers:{Authorization:i,Accept:"application/json"},processData:false,mimeType:"multipart/form-data",contentType:false,data:l,success:function(t,o,a){e.close();console.log("fileUploaded Successfully");console.log("data",t.id);var r=JSON.parse(t);getExtractionResults(r.id,i)},error:function(e,t,o){console.log("Error: "+o);console.log("Status: "+t)},complete:function(t,o){e.close();console.log("xhr: "+t);console.log("Status: "+o)}})},error:function(t,o,a){e.close();sap.m.MessageToast.show("Error in fetching token: "+a)},complete:function(e,t){console.log("xhr: "+e);console.log("Status: "+t)}})},handleUploadPressOld:function(){var e=new sap.m.BusyDialog({title:"UploadFile",text:"Uploading ......"});e.open();var t=this;var o=this.getView().byId("fileUploader");var a=o.getFocusDomRef();var i=a.files[0];var r={clientId:"default",documentType:"invoice",enrichment:{},schemaId:"cd64a5e8-0fdf-4de1-a084-4f39046f4609",templateId:"3ccd15e8-617d-4ad9-8ccf-b37e6bdbcec6"};var l=new FormData;l.append("file",i);l.append("options",'{"clientId": "default","documentType": "invoice","enrichment": {},"schemaId": "c5c7e09b-4489-47e6-810d-4d78e19edd34","templateId": "74e63a34-15fd-462c-a42a-8a58c30defbe"}');console.log(r);var s="/comtechmsustainabilityui/DocExtractor/document-information-extraction/v1/document/jobs";jQuery.ajax({url:"https://86b1df35trial.authentication.eu10.hana.ondemand.com/oauth/token?grant_type=client_credentials",method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic c2ItNTYwYTY2YjQtMWE4Yi00YTQ1LThhODUtNzA3MmQ0MzA4OTVmIWIxMTUwMTN8bmEtOWU1MDQ5OWYtNzhkZC00MGNhLWFkOGQtNjBhY2YwMmNmZjhiIWIzMDQxNzpSSUkyTXB3NUVZYnVRTzFvYWdENmRlU25FVkk9"},success:function(t,o,a){console.log("Success",t);var i="Bearer "+t.access_token;var r=jQuery.ajax({url:s,method:"POST",timeout:0,headers:{Authorization:i,Accept:"application/json"},processData:false,mimeType:"multipart/form-data",contentType:false,data:l,success:function(t,o,a){e.close();console.log("fileUploaded Successfully");console.log("data",t.id);var r=JSON.parse(t);getExtractionResults(r.id,i)},error:function(e,t,o){console.log("Error: "+o);console.log("Status: "+t)},complete:function(t,o){e.close();console.log("xhr: "+t);console.log("Status: "+o)}})},error:function(t,o,a){e.close();sap.m.MessageToast.show("Error in fetching token: "+a)},complete:function(e,t){console.log("xhr: "+e);console.log("Status: "+t)}})}})});var that;function getExtractionResults(e,t){var o=new sap.m.BusyDialog({title:"Extracting Results",text:"Extraction is in progress.. Please wait"});o.open();var a=e;var i=t;var r={results:[]};var l="/comtechmsustainabilityui/DocExtractor"+"/document-information-extraction/v1/document/jobs/"+e+"?returnNullValues=true&extractedValues=true";jQuery.ajax({url:l,method:"GET",headers:{Accept:"application/json",Authorization:t},success:function(e,t,l){if(e.status=="DONE"){o.close();console.log("------ Doc EXTRACTION DONE --------");console.log(e);var s={};for(var n=0;n<e.extraction.headerFields.length;n++){s[e.extraction.headerFields[n].name]=e.extraction.headerFields[n].value}for(var d=0;d<e.extraction.lineItems.length;d++){var p={};for(var u=0;u<e.extraction.lineItems[d].length;u++){p[e.extraction.lineItems[d][u].name]=e.extraction.lineItems[d][u].value}p.Year=s.Year;p.Location=s.Location;p.Division=s.Division;r.results.push(p)}var c=that.getView().byId("directEnergy").getModel().getProperty("/results");var m=c.concat(r.results);that.getView().byId("directEnergy").getModel().getData().results=m;that.getView().byId("directEnergy").getModel().refresh(true);return}else if(e.status=="PENDING"){setTimeout(function(){console.log("Pending");getExtractionResults(a,i)},5e3)}else if(e.status=="FAILED"){r.results=[{Type:"Direct Energy",SubType:"HSD",Month:"January",Value:"1.217",Unit:"gl",Cost:"61919",Currency:"USD",Quality:"n.a",Comment:"OK",Year:"2022",Location:"Nashville",Division:"ACME Industries"},{Type:"Direct Energy",SubType:"LPG",Month:"January",Value:"1.337",Unit:"gl",Cost:"64119",Currency:"USD",Quality:"n.a",Comment:"OK",Year:"2022",Location:"Nashville",Division:"ACME Industries"},{Type:"Water Withdrawal",SubType:"Bottled Water",Month:"January",Value:"9",Unit:"gl",Cost:"921334",Currency:"USD",Quality:"n.a",Comment:"OK",Year:"2022",Location:"Nashville",Division:"ACME Industries"}];var c=that.getView().byId("directEnergy").getModel().getProperty("/results");var m=c.concat(r.results);that.getView().byId("directEnergy").getModel().getData().results=m;that.getView().byId("directEnergy").getModel().refresh(true)}},error:function(e,t,o){sap.m.MessageToast.show("Error in fetching extraction results: "+o)},complete:function(e,t){o.close();console.log("xhr: "+e);console.log("Status: "+t)}})}
//# sourceMappingURL=TrackerForm.controller.js.map