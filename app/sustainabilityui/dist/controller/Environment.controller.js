sap.ui.define(["sap/ui/core/mvc/Controller","sap/m/MessageBox"],function(e,t){"use strict";return e.extend("com.techm.sustainabilityui.controller.Environment",{onInit:function(){let e=sap.ui.core.UIComponent.getRouterFor(this);this.UserInputMonth="";this.UserInputCurrency="";this.Scope="";this.monthArr=[];this.yearArr=[];this.attachFile=[];this.OData=this.getOwnerComponent().getModel("dataModel");var t=this;this.yearA="";this.StartDate="";this.EndDate="";this.OutputUoM="";this.flag="";this.oRouter=this.getOwnerComponent().getRouter();this.oRouter.getTarget("Environment").attachDisplay(jQuery.proxy(this.handleRouteMatched,this))},handleRouteMatched:function(e){this.FileArr=[];this.GlobalIndustryModel=sap.ui.getCore().getModel("GlobalIndustryModel");console.log("on before Env:"+this.GlobalIndustryModel.getData());var t=this;var a=this.GlobalIndustryModel.getData().Industry;if(a==="Telecom"){t.getView().byId("box0").setSelectedKey("Bharti Airtel Limited");t.getView().byId("box1").setSelectedKey("Maharashtra");t.getView().byId("box2").setSelectedKey("")}this.onPressGo()},onPressBack:function(e){this.getView().byId("box0").setSelectedKey("");this.getView().byId("box1").setSelectedKey("");this.getView().byId("box2").setSelectedKey("");this.getOwnerComponent().getRouter().navTo("Launchpad",{},true)},handleUploadPress:function(){var e=new sap.m.BusyDialog({title:"UploadFile",text:"Uploading ......"});e.open();that=this;var t=this.getView().byId("fileUploader");var a=t.getFocusDomRef();var o=a.files[0];var s={clientId:"default",documentType:"custom",enrichment:{},schemaId:"c5c7e09b-4489-47e6-810d-4d78e19edd34",templateId:"74e63a34-15fd-462c-a42a-8a58c30defbe"};var r=new FormData;r.append("file",o);r.append("options",'{"clientId": "default","documentType": "custom","enrichment": {},"schemaId": "c5c7e09b-4489-47e6-810d-4d78e19edd34","templateId": "74e63a34-15fd-462c-a42a-8a58c30defbe"}');console.log(s);var l="/comtechmsustainabilityui/DocExtractor/document-information-extraction/v1/document/jobs";jQuery.ajax({url:"https://86b1df35trial.authentication.eu10.hana.ondemand.com/oauth/token?grant_type=client_credentials",method:"GET",headers:{"Content-Type":"application/x-www-form-urlencoded",Authorization:"Basic c2ItNTYwYTY2YjQtMWE4Yi00YTQ1LThhODUtNzA3MmQ0MzA4OTVmIWIxMTUwMTN8bmEtOWU1MDQ5OWYtNzhkZC00MGNhLWFkOGQtNjBhY2YwMmNmZjhiIWIzMDQxNzpSSUkyTXB3NUVZYnVRTzFvYWdENmRlU25FVkk9"},success:function(t,a,o){console.log("Success",t);var s="Bearer "+t.access_token;var n=jQuery.ajax({url:l,method:"POST",timeout:0,headers:{Authorization:s,Accept:"application/json"},processData:false,mimeType:"multipart/form-data",contentType:false,data:r,success:function(t,a,o){e.close();console.log("fileUploaded Successfully");console.log("data",t.id);var r=JSON.parse(t);getExtractionResults(r.id,s)},error:function(e,t,a){console.log("Error: "+a);console.log("Status: "+t)},complete:function(t,a){e.close();console.log("xhr: "+t);console.log("Status: "+a)}})},error:function(t,a,o){e.close();sap.m.MessageToast.show("Error in fetching token: "+o)},complete:function(e,t){console.log("xhr: "+e);console.log("Status: "+t)}})},onExportExcel:function(e){this._import(e.getParameter("files")&&e.getParameter("files")[0])},_import:function(e){var t=this;var a={};if(e&&window.FileReader){var o=new FileReader;o.onload=function(e){var o=e.target.result;var s=XLSX.read(o,{type:"binary"});s.SheetNames.forEach(function(e){a=XLSX.utils.sheet_to_row_object_array(s.Sheets[e])});var r=a.length;for(var l=0;l<r;l++){a[l].isExistingRow=false;a[l].isNewRow=true}var n=[];var i=t.EnvModel.getData().results;i.push(...a);t.EnvModel.setData({results:i});t.EnvModel.refresh(true)};o.onerror=function(e){console.log(e)};o.readAsBinaryString(e)}},onPressDataUpload:function(e){var t=this;this.batchChanges=[];this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchModel.setUseBatch(true);var a=this.getOwnerComponent().getModel("dataModel");for(var o=0;o<t.EnvModel.getData().results.length;o++){{var s={Year:t.EnvModel.getData().results[o].Year,Month:t.EnvModel.getData().results[o].Month,Location:t.EnvModel.getData().results[o].Location,Type:t.EnvModel.getData().results[o].Type,SubType:t.EnvModel.getData().results[o].SubType,KPI:t.EnvModel.getData().results[o].KPI,Sno:0,Value:parseFloat(t.EnvModel.getData().results[o].Value),Unit:t.EnvModel.getData().results[o].Unit,IUnit:"",IValue:0,Cost:parseFloat(t.EnvModel.getData().results[o].Cost),Currency:t.EnvModel.getData().results[o].Currency,Quality:"OK",Comment:t.EnvModel.getData().results[o].Comment,FiscalType:t.EnvModel.getData().results[o].FiscalType,YearA:t.EnvModel.getData().results[o].YearA,StartDate:t.EnvModel.getData().results[o].StartDate,EndDate:t.EnvModel.getData().results[o].EndDate,fiscal:t.EnvModel.getData().results[o].fiscal,Owner:t.EnvModel.getData().results[o].Owner,Approver:t.EnvModel.getData().results[o].Approver,Division:t.EnvModel.getData().results[o].Division,Date:null,Value2:parseFloat(t.EnvModel.getData().results[o].Value2),Unit2:t.EnvModel.getData().results[o].Unit2,Distance:null,Weight:null,Scope:t.EnvModel.getData().results[o].Scope,Associates:null,Logic:t.EnvModel.getData().results[o].Logic,Measure:t.EnvModel.getData().results[o].Measure,Standard1:t.EnvModel.getData().results[o].Standard1,LogicE:t.EnvModel.getData().results[o].LogicE,GRIStd:t.EnvModel.getData().results[o].GRIStd,SDG:t.EnvModel.getData().results[o].SDG,Class:t.EnvModel.getData().results[o].Class,RenNon:t.EnvModel.getData().results[o].RenNon,FValue:0,FValue1:0};a.create("/Environment_Report",s,null,function(){sap.m.MessageToast.show("The details submitted Successfully!!!")},function(){alert("Create failed")})}}},onPressGo:function(e){var a=this;this.KPIListModel=new sap.ui.model.json.JSONModel;var o=new sap.m.BusyDialog({});o.open();var s=this.getOwnerComponent().getModel("dataModel");this.OData.read("/KPIList",{success:function(e,t){o.close();var s=new sap.ui.model.json.JSONModel;s.setData(e);a.getView().byId("KPISubType").setModel(s,"KPIModel");a.getView().byId("KPI").setModel(s,"KPIModel");a.KPIListModel.setData(e);console.log(a.KPIListModel);a._getKPITypes();a._getKPISubTypes()},error:function(e){o.close()}});this.OData.read("/Constants",{success:function(e,t){console.log("success");var o=new sap.ui.model.json.JSONModel;o.setData(e);a.getView().setModel(o,"ConstantsModel");var s=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry},error:function(e){console.log("Error")}});var r="/UOM";this.OData.read(r,{success:function(e,t){var o=new sap.ui.model.json.JSONModel;o.setData(e);a.getView().byId("cbUnitTable1").setModel(o,"UOMListModel");a.getView().byId("cbUnitTable2").setModel(o,"UOMListModel");a.getView().byId("cbUnit1Table3").setModel(o,"UOMListModel");a.getView().byId("cbUnit2Table3").setModel(o,"UOMListModel");a.getView().byId("cbUnit1Table4").setModel(o,"UOMListModel");a.getView().byId("cbUnit2Table4").setModel(o,"UOMListModel");a.getView().byId("cbUnitTable6_1").setModel(o,"UOMListModel");a.getView().byId("cbUnitTable6_2").setModel(o,"UOMListModel")},error:function(e){t.error("Error")}});var l=this.GlobalIndustryModel.getData().Industry;var n=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:l});this.OData.read("/Division",{success:function(e,t){var o=new sap.ui.model.json.JSONModel;o.setData(e);a.getView().setModel(o,"divisionModel");var s=a.getView().byId("box0");var r=s.getBinding("items");r.filter(n)},error:function(e){t.error("Error")}});var l=this.GlobalIndustryModel.getData().Industry;var n=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:l});this.OData.read("/Location",{success:function(e,t){var o=new sap.ui.model.json.JSONModel;o.setData(e);a.getView().setModel(o,"locationModel");var s=a.getView().byId("box1");var r=s.getBinding("items");r.filter(n)},error:function(e){t.error("Error")}});this.calloData_Year();this.calloData_MeasureValidation1();var i=this.GlobalIndustryModel.getData().Industry;if(i==="IT"){this.getView().byId("lblLocation").setText("Location")}else if(i==="Telecom"){this.getView().byId("lblLocation").setText("Circle")}},calloData_Year:function(){var e=this;var a=this.getOwnerComponent().getModel("dataModel");var o=this.GlobalIndustryModel.getData().Industry;var s=new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:o});this.OData.read("/Year_Module",{success:function(t,a){var o=new sap.ui.model.json.JSONModel;o.setData(t);e.getView().setModel(o,"yearModel");var r=e.getView().byId("box2");var l=r.getBinding("items");l.filter(s)},error:function(e){t.error("Error")}})},onUpdateFinished:function(){var e=this.GlobalIndustryModel.getData().Industry;if(e==="IT"){this.getView().byId("lblLocation").setText("Location")}else if(e==="Telecom"){this.getView().byId("lblLocation").setText("Circle")}},onChangeYear:function(e){var t=this.getView().byId("box2").getModel("yearModel").getData().results;var a=this.getView().byId("box2").getSelectedKey();var o="";var s="",r="";for(var l=0;l<t.length;l++){if(t[l].fiscal===a){s=t[l].StartDate;r=t[l].EndDate;o=t[l].YearA}}this.getView().byId("dateDisp").setText("("+s+" to "+r+")");this.StartDate=s;this.EndDate=r;this.yearA=o;var n=s.split("-");var i=n[0];var d=n[1];var c=n[2];console.log("element2:"+d);var g=r.split("-");var u=g[0];var h=g[1];var y=g[2];console.log("element5:"+h);const p=["January","February","March","April","May","June","July","August","September","October","November","December"];var b=new Date(s);var v=new Date(s).getMonth();var m=new Date(r).getMonth();console.log("startDate:"+p[v]);console.log("endDate:"+p[m]);console.log("m1:"+v);console.log("m2:"+m);var I=new Date(parseInt(c),parseInt(v),parseInt(i));var w=new Date(parseInt(y),parseInt(m),parseInt(u));var M=w.getYear()-I.getYear();var f=w.getMonth()-I.getMonth();var T=M*12+f;var E=[];for(var l=0;l<=T;l++){if(l==0)I.setMonth(I.getMonth()-1);else I.setMonth(I.getMonth()+1);E[l]=moment(I).format("MMMM")}let V=new Date(c,parseInt(v),i);let S=new Date(y,parseInt(m),u);var D="en";let K=new Date(V.getFullYear(),V.getMonth());let x=[];this.monthArr=[];this.yearArr=[];while(K<=S){x.push(K.toLocaleString(D,{month:"long"}));this.monthArr.push(K.toLocaleString(D,{month:"long"}));this.yearArr.push(K.toLocaleString(D,{year:"numeric"}));K.setMonth(K.getMonth()+1)}console.log("months before:"+x);if(d===h&x.length>12){if(x!=null&&x!=undefined&&x.length>0){var P=x.splice(x.length-1,1);console.log("months removed:"+P)}}console.log("months after:"+x);var C={items:x};var O=new sap.ui.model.json.JSONModel;O.setData(C);console.log(C);var U=this.getView().byId("month");U.setModel(O);U.bindAggregation("items","/items",new sap.ui.core.ListItem({text:"{}",key:"{}"}))},_getUOMComboBoxValues:function(){var e=[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:this.KPIMeasure})];var t=[new sap.ui.model.Filter({path:"Measure",operator:sap.ui.model.FilterOperator.EQ,value1:this.KPIMeasure2})];var a=this.getView().byId("cbUnitTable1").getModel("UOMListModel");var o=this.getView().byId("cbUnitTable2").getModel("UOMListModel");var s=this.getView().byId("cbUnit1Table3").getModel("UOMListModel");var r=this.getView().byId("cbUnit2Table3").getModel("UOMListModel");var r=this.getView().byId("cbUnitTable6_1").getModel("UOMListModel");var r=this.getView().byId("cbUnitTable6_2").getModel("UOMListModel");var l=new sap.ui.core.ListItem({key:"{UOMListModel>Abbreviation}",text:"{UOMListModel>Abbreviation}"});this.getView().byId("cbUnitTable1").bindAggregation("items",{path:"UOMListModel>/results",template:l,filters:e});this.getView().byId("cbUnitTable2").bindAggregation("items",{path:"UOMListModel>/results",template:l,filters:e});this.getView().byId("cbUnit1Table3").bindAggregation("items",{path:"UOMListModel>/results",template:l,filters:e});this.getView().byId("cbUnit2Table3").bindAggregation("items",{path:"UOMListModel>/results",template:l,filters:e});this.getView().byId("cbUnitTable6_1").bindAggregation("items",{path:"UOMListModel>/results",template:l,filters:e});this.getView().byId("cbUnitTable6_2").bindAggregation("items",{path:"UOMListModel>/results",template:l,filters:t})},_getKPITypes:function(){var e=[];var t=this.KPIListModel.getData().results;for(var a=0;a<t.length;a++){if(e.indexOf(t[a].Type)===-1){e.push(t[a].Type)}}console.log("Type:"+e);var o={items:e};var s=new sap.ui.model.json.JSONModel;s.setData(o.items);var r=this.getView().byId("rbgKPITypes");r.setModel(s,"KPITypeModel");console.log(s);var l=r.getSelectedIndex();this.KPITypeSelected=s.getData()[l]},_getKPISubTypes:function(){var e=this;var t=e.getView().byId("KPISubType").getModel("KPIModel");var a=this.KPITypeSelected;var o=[];var s=[];var r=t.getData().results;for(var l=0;l<r.length;l++){if(r[l].Type===a){for(var n=0;n<r.length;n++){if(o.indexOf(r[n].SubType)===-1&&r[n].Type===a){o.push(r[n].SubType)}}}}console.log(o);for(var l=0;l<o.length;l++){var i={};i.SubType=o[l];s.push(i)}console.log(s);var d={items:s};var c=new sap.ui.model.json.JSONModel;c.setData(d);console.log(d);var g=e.getView().byId("KPISubType");g.setModel(c);g.bindAggregation("items","/items",new sap.ui.core.ListItem({text:"{SubType}",key:"{SubType}"}));e.getView().byId("KPISubType").setSelectedKey(o[0]);this.KPISubtypeSelected=o[0];this._getKPIs()},_getKPIs:function(){var e=this;var t=e.getView().byId("KPISubType").getModel("KPIModel");var a=this.KPITypeSelected;var o=this.KPISubtypeSelected;var s=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:a}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:o})],and:true});console.log(s);var r=new sap.ui.core.ListItem({key:"{KPIModel>KPI}",text:"{KPIModel>KPI}"});var l=e.getView().byId("KPI");l.bindAggregation("items",{path:"KPIModel>/results",template:r,filters:s});this.KPI=l.getFirstItem().getKey();l.setSelectedKey(l.getFirstItem().getKey());this._populateKPITableData()},_populateKPITableData:function(){var e=this;var t=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var a=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Division",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box0").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box1").getSelectedKey()}),new sap.ui.model.Filter({path:"fiscal",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:""+this.KPITypeSelected}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("KPISubType").getSelectedKey()}),new sap.ui.model.Filter({path:"KPI",operator:sap.ui.model.FilterOperator.EQ,value1:e.getView().byId("KPI").getSelectedKey()}),new sap.ui.model.Filter({path:"Industry",operator:sap.ui.model.FilterOperator.EQ,value1:t})],and:true});console.log(a);this._getKPITemplate();console.log(this.template);var o="/Environment_Report";switch(this.template){case"Table 1":var s=this.getView().byId("EnvTable");this._callTemplate1(a,o,s);e.getView().byId("EnvTable").setVisible(true);this.getView().byId("EnvTable2").setVisible(false);this.getView().byId("EnvTable3").setVisible(false);this.getView().byId("EnvTable4").setVisible(false);this.getView().byId("EnvTable5").setVisible(false);this.getView().byId("Table6").setVisible(false);break;case"Table 2":var s=this.getView().byId("EnvTable2");this._callTemplate1(a,o,s);this.getView().byId("EnvTable").setVisible(false);this.getView().byId("EnvTable2").setVisible(true);this.getView().byId("EnvTable3").setVisible(false);this.getView().byId("EnvTable4").setVisible(false);this.getView().byId("EnvTable5").setVisible(false);this.getView().byId("Table6").setVisible(false);break;case"Table 3":var s=this.getView().byId("EnvTable3");this._callTemplate1(a,o,s);this.getView().byId("EnvTable").setVisible(false);this.getView().byId("EnvTable2").setVisible(false);this.getView().byId("EnvTable3").setVisible(true);this.getView().byId("EnvTable4").setVisible(false);this.getView().byId("EnvTable5").setVisible(false);this.getView().byId("Table6").setVisible(false);break;case"Table EUI":var o="/Environment_EUI_Ports";var s=this.getView().byId("EnvTable4");this._callTemplate1(a,o,s);this.getView().byId("EnvTable").setVisible(false);this.getView().byId("EnvTable2").setVisible(false);this.getView().byId("EnvTable3").setVisible(false);this.getView().byId("EnvTable4").setVisible(true);this.getView().byId("EnvTable5").setVisible(false);this.getView().byId("Table6").setVisible(false);break;case"Table RTG":case"Table 6":var o="/"+this.GlobalIndustryModel.getData().TransactionTable;var s=this.getView().byId("Table6");this._callTemplate1(a,o,s);if(this.Measure==="No Selection"){this.getView().byId("cbUnitTable6_1").setEditable(false)}if(this.Measure2==="No Selection"){this.getView().byId("cbUnitTable6_2").setEditable(false)}this.getView().byId("EnvTable").setVisible(false);this.getView().byId("EnvTable2").setVisible(false);this.getView().byId("EnvTable3").setVisible(false);this.getView().byId("EnvTable4").setVisible(false);this.getView().byId("EnvTable5").setVisible(false);this.getView().byId("Table6").setVisible(true);break}},_callTemplate1:function(e,t,a){this._getUOMComboBoxValues();var o=this;this.EnvModel=new sap.ui.model.json.JSONModel;this.OData.read(t,{filters:[e],success:function(e,t){var s=new sap.ui.model.json.JSONModel;s.setData(e);o.EnvModel.setData(e);var r=[],l=[];var n=e.results.length;for(var i=0;i<n;i++){o.EnvModel.getData().results[i].isExistingRow=true;o.EnvModel.getData().results[i].isNewRow=false;r.push(o.EnvModel.getData().results[i].supplier)}o._setTableData(a)},error:function(e){}})},_setTableData:function(e){e.setModel(this.EnvModel,"EnvModel")},_getKPITemplate:function(){var e=this.KPIListModel.getData().results.length;for(var t=0;t<e;t++){var a=this.KPIListModel.getData().results[t];if(a.Type===this.KPITypeSelected&&a.SubType===this.KPISubtypeSelected&&a.KPI===this.KPI){console.log("KPI match found"+a.KPI);this.scope=a.Scope;this.template=a.Template;this.KPIMeasure=a.Measure;this.KPILogic=a.EmissionLogic;this.KPIGRIStd=a.GRIStd;this.KPISDG=a.SDG;this.KPIClass=a.Class;this.KPIRenNon=a.RenNon;this.KPIMeasure2=a.Measure2;this.Standard1=a.Standard1;this.LogicE=a.EnergyLogic;break}else continue}},onChangeKPI:function(e){this.KPI=e.getParameters().selectedItem.getProperty("key");console.log("onChangeKPI:"+this.KPI);this._populateKPITableData()},onChangeVendor:function(e){var t=this;this.vendor=e.getParameters().selectedItem.getProperty("key");console.log("onChangeVendor:"+this.vendor);var a=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"Division",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box0").getSelectedKey()}),new sap.ui.model.Filter({path:"Location",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box1").getSelectedKey()}),new sap.ui.model.Filter({path:"fiscal",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("box2").getSelectedKey()}),new sap.ui.model.Filter({path:"Type",operator:sap.ui.model.FilterOperator.EQ,value1:""+this.KPITypeSelected}),new sap.ui.model.Filter({path:"SubType",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("KPISubType").getSelectedKey()}),new sap.ui.model.Filter({path:"KPI",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("KPI").getSelectedKey()}),new sap.ui.model.Filter({path:"supplier",operator:sap.ui.model.FilterOperator.EQ,value1:t.getView().byId("vendor").getSelectedKey()})],and:true});var o=t.getView().byId("EnvTable");var s=o.getBinding("items");s.filter(a);t.getView().byId("EnvTable").getModel("EnvModel").refresh(true)},onSelect_Radiobutton_KPIType:function(e){var t=this;var a=e.getSource().getButtons()[e.getParameter("selectedIndex")].getText();this.KPITypeSelected=a;console.log("txt:"+a);t._getKPISubTypes()},onChange_ComboBox_KPISubType:function(e){var t=this;var a=e.getParameter("selectedItem").getText();this.KPISubtypeSelected=a;this._getKPIs()},OnPressAddNewEntry:function(e){var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.getView().byId("KPI").getSelectedKey();var r=this.Scope;var l={results:[]};l.results=[{Month:"",Type:""+o,SubType:""+a,KPI:"",Value:"",Unit:"",Cost:"",Currency:"",Quality:"",Comment:"",Owner:"",Approver:"",isNewRow:true,isExistingRow:false,Scope:""+r,supplier:"",url:"",Industry:""}];t.getView().byId("EnvTable").getModel("EnvModel").getData().results=t.getView().byId("EnvTable").getModel("EnvModel").getProperty("/results").concat(l.results);t.getView().byId("EnvTable").getModel("EnvModel").refresh(true)},OnPressAddNewEntryEnvTable2:function(e){var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.getView().byId("KPI").getSelectedKey();var r=this.Scope;var l={results:[]};l.results=[{Sno:"",Type:""+o,SubType:""+a,KPI:"",Date:"",Value:"",Unit:"",Cost:"",Currency:"",Class:"",Quality:"",Comment:"",Owner:"",Approver:"",isNewRow:true,isExistingRow:false,Scope:""+r}];t.getView().byId("EnvTable2").getModel("EnvModel").getData().results=t.getView().byId("EnvTable2").getModel("EnvModel").getProperty("/results").concat(l.results);var n=t.getView().byId("EnvTable2").getModel("EnvModel").oData.results.length;t.getView().byId("EnvTable2").getModel("EnvModel").oData.results[n-1].Sno=n;t.getView().byId("EnvTable2").getModel("EnvModel").refresh(true)},OnPressAddNewEntryEnvTable3:function(e){var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.getView().byId("KPI").getSelectedKey();var r=this.Scope;var l={results:[]};l.results=[{Sno:"",Type:""+o,SubType:""+a,KPI:"",Date:"",Distance:"",Unit1:"",Weight:"",Unit2:"",Cost:"",Currency:"",Transport:"",Quality:"",Comment:"",Owner:"",Approver:"",isNewRow:true,isExistingRow:false,Scope:""+r}];t.getView().byId("EnvTable3").getModel("EnvModel").getData().results=t.getView().byId("EnvTable3").getModel("EnvModel").getProperty("/results").concat(l.results);var n=t.getView().byId("EnvTable3").getModel("EnvModel").oData.results.length;t.getView().byId("EnvTable3").getModel("EnvModel").oData.results[n-1].Sno=n;t.getView().byId("EnvTable3").getModel("EnvModel").refresh(true)},OnPressAddNewEntryEnvTable4:function(e){var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.getView().byId("KPI").getSelectedKey();var r=this.Scope;var l={results:[]};l.results=[{Site:"",Type:""+o,SubType:""+a,KPI:"",ValueE:"",Unit1:"",Cost:"",Currency:"",ValueA:"",Unit2:"",Quality:"",Comment:"",Owner:"",Approver:"",isNewRow:true,isExistingRow:false,Scope:""+r}];t.getView().byId("EnvTable4").getModel("EnvModel").getData().results=t.getView().byId("EnvTable4").getModel("EnvModel").getProperty("/results").concat(l.results);t.getView().byId("EnvTable4").getModel("EnvModel").refresh(true)},OnPressAddNewEntryEnvTable5:function(e){var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.getView().byId("KPI").getSelectedKey();var r=this.Scope;var l={results:[]};l.results=[{Month:"",Type:""+o,SubType:""+a,KPI:"",Value:"",Cost:"",Currency:"",Quality:"",Comment:"",Owner:"",Approver:"",isNewRow:true,isExistingRow:false,Scope:""+r}];t.getView().byId("EnvTable5").getModel("EnvModel").getData().results=t.getView().byId("EnvTable5").getModel("EnvModel").getProperty("/results").concat(l.results);t.getView().byId("EnvTable5").getModel("EnvModel").refresh(true)},OnPressAddNewEntryTable6:function(e){var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.getView().byId("KPI").getSelectedKey();var r=this.Scope;var l={results:[]};l.results=[{Month:"",Type:""+o,SubType:""+a,KPI:"",Value:"",Unit:"",Value2:"",Unit2:"",Cost:"",Currency:"",Quality:"",Comment:"",Owner:"",Approver:"",isNewRow:true,isExistingRow:false,Scope:""+r}];t.getView().byId("Table6").getModel("EnvModel").getData().results=t.getView().byId("Table6").getModel("EnvModel").getProperty("/results").concat(l.results);t.getView().byId("Table6").getModel("EnvModel").refresh(true)},handleConnectToLocalSystem:function(e){if(!this.pDialog){this.pDialog=this.loadFragment({name:"com.techm.sustainabilityui.fragment.ConnectToLocalSystem"})}this.pDialog.then(function(e){e.open()})},onCloseDialog:function(){this.byId("simpleDialog").close()},onOkDialog:function(){sap.m.MessageToast.show("The system details are updated.!!");this.byId("simpleDialog").close()},handleDownloadExcel:function(e){window.open("./documents/Table1.xlsx")},onChangeMonth:function(e){console.log(e);var t=e.getParameter("selectedItem").getText();var a=parseInt(e.getParameter("id").substring(e.getParameter("id").lastIndexOf("clone")+5));var o=this.getView().byId("EnvTable").getModel("EnvModel").getData().results;console.log(t);this.UserInputMonth=t},onChangeCurrency:function(e){var t=e.getParameter("selectedItem").getText();console.log(t);this.UserInputCurrency=t},onChangeUnit:function(e){var t=e.getParameter("selectedItem").getText();console.log("onChangeUnit"+t);this.Unit1=t},onChangeUnit1:function(e){var t=e.getParameter("selectedItem").getText();console.log(""+t);this.Unit1=t},onChangeUnit2:function(e){var t=e.getParameter("selectedItem").getText();console.log(""+t);this.Unit2=t},formatQuality:function(e){if(e==="OK"){return true}else{return false}},formatDate:function(e){if(e!==null&&e!==""){var t=e;var a=new Date(t),o=("0"+(a.getMonth()+1)).slice(-2),s=("0"+a.getDate()).slice(-2),r=a.getFullYear();var a=new Date(`${r}-${o}-${s}`);var l=sap.ui.core.format.DateFormat.getDateInstance({pattern:"yyyy-MM-dd"});var n=l.format(a);return n}else{return e}},onPressSubmit:function(e){this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchModel.setUseBatch(true);this.batchChanges=[];var t=this;if(this.template==="Table 1"){this.onCreateEntry_Table1();this.onUpdateEntry_Table1();this.batchModel.submitChanges({success:function(e,t){sap.m.MessageBox.show("Request has been submitted successfully! ",{icon:sap.m.MessageBox.Icon.INFORMATION,title:"Success",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})},error:function(e){sap.m.MessageBox.show("Unable to reach server. Please try again later! ",{icon:sap.m.MessageBox.Icon.INFORMATION,title:"Success",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})}})}else if(this.template==="Table 2"){this.onCreateEntry_Table2();this.onUpdateEntry_Table2();this.batchModel.submitChanges({success:function(e,t){sap.m.MessageBox.show("Request has been submitted successfully! ",{icon:sap.m.MessageBox.Icon.INFORMATION,title:"Success",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})},error:function(e){sap.m.MessageBox.show("Unable to reach server. Please try again later! ",{icon:sap.m.MessageBox.Icon.INFORMATION,title:"Success",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})}})}else if(this.template==="Table 3"){this.onCreateEntry_Table3();this.onUpdateEntry_Table3();if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh();this.getView().byId("EnvTable3").getModel("EnvModel").refresh(true)}else console.log("No Record present for Database Operation")}else if(this.template==="Table EUI"){this.onCreateEntry_Table4();this.onUpdateEntry_Table4();if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh();this.getView().byId("EnvTable4").getModel("EnvModel").refresh(true)}else console.log("No Record present for Database Operation")}else if(this.template==="Table RTG"){this.onCreateEntry_Table1();this.onUpdateEntry_Table1();if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh();this.getView().byId("EnvTable5").getModel("EnvModel").refresh(true)}else console.log("No Record present for Database Operation")}else if(this.template==="Table 6"){this.onCreateEntry_Table1();this.onUpdateEntry_Table1();if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitBatch();this.batchModel.refresh();this.getView().byId("Table 6").getModel("EnvModel").refresh(true)}else console.log("No Record present for Database Operation")}else if(this.template==="Table RTG1"){this.onCreateEntry_Table1();this.onUpdateEntry_Table1();if(this.batchChanges.length>0){this.batchModel.addBatchChangeOperations(this.batchChanges);this.batchModel.submitChanges({success:function(e,t){sap.m.MessageBox.show("Request has been submitted successfully! ",{icon:sap.m.MessageBox.Icon.INFORMATION,title:"Success",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})},error:function(e){sap.m.MessageBox.show("Unable to connect to server, try again later ",{icon:sap.m.MessageBox.Icon.INFORMATION,title:"Success",actions:[sap.m.MessageBox.Action.OK],onClose:function(e){}})}});this.batchModel.refresh();this.getView().byId("EnvTable5").getModel("EnvModel").refresh(true)}else console.log("No Record present for Database Operation")}},onCreateEntry_Table1:function(e){console.log("on submit"+this.flag);if(this.flag==="template"){this.onPressTemplateUpload()}else{var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.UserInputMonth;var r=this.UserInputCurrency;var l=this.getView().byId("KPI").getSelectedKey();var n=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;if(this.template==="Table 6"){var i=t.getView().byId("Table6").getModel("EnvModel")}else{var i=t.getView().byId("EnvTable").getModel("EnvModel")}var d=this.getOwnerComponent().getModel("dataModel");var c=this.Scope;var g=this.Unit1;var u=this.Unit2;var h="";if(t.getView().byId("box2").getSelectedKey().length===3){h=true}else{h=false}console.log("monthArr:"+this.monthArr);for(var y=0;y<i.getData().results.length;y++){if(i.getData().results[y].isNewRow){var p=this.monthArr.indexOf(i.getData().results[y].Month);var b=this.yearArr[p];var v="";if(o==="NETWORK TRAFFIC"){v=""}else{v=this.LogicE}console.log("Year:"+b);var m={Industry:n,Year:b,Month:""+i.getData().results[y].Month,Location:t.getView().byId("box1").getSelectedKey(),Type:""+o,SubType:""+a,KPI:l,Value:parseFloat(i.getData().results[y].Value),Unit:i.getData().results[y].Unit,Cost:parseFloat(i.getData().results[y].Cost),Currency:""+r,Quality:"OK",Comment:i.getData().results[y].Comment,Owner:i.getData().results[y].Owner,Approver:i.getData().results[y].Approver,Division:t.getView().byId("box0").getSelectedKey(),Sno:0,url:i.getData().results[y].url,Date:null,Value2:parseFloat(i.getData().results[y].Value2),Unit2:i.getData().results[y].Unit2,Distance:null,Weight:null,Scope:this.Scope,Associates:null,Logic:this.KPILogic,Measure:this.KPIMeasure,GRIStd:this.KPIGRIStd,SDG:this.KPISDG,Class:this.KPIClass,RenNon:this.KPIRenNon,FValue:0,FValue1:0,FiscalType:h,YearA:this.yearA,fiscal:t.getView().byId("box2").getSelectedKey(),isValidationRequired:false,StartDate:this.StartDate,EndDate:this.EndDate,Standard1:this.Standard1,LogicE:v};console.log("jsustain");console.log(m);var I=this.GlobalIndustryModel.getData().TransactionTable;var w="/Environment_Report";t.batchModel.create(w,m,{method:"POST",success:function(e){},error:function(e){}})}console.log(t.batchModel)}}},handleEditBtn:function(e){var t=this;var a="EnvTable";var o="Environment_Report";var s=this.getView().byId(a).getModel("EnvModel");var r=this.getView().byId(a).getSelectedItems();var l=this.KPITypeSelected;var n=this.KPISubtypeSelected;var i=this.getView().byId("KPI").getSelectedKey();var d=t.getView().byId("box1").getSelectedKey();var c=t.getView().byId("box0").getSelectedKey();for(var g=0;g<r.length;g++){var u=r[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;for(var h=0;h<s.getData().results.length;h++){if(l===s.getData().results[h].Type&&n===s.getData().results[h].SubType&&i===s.getData().results[h].KPI&&d===s.getData().results[h].Location&&c===s.getData().results[h].Division&&u===s.getData().results[h].Month){s.getData().results[h].isEditableRow=true;break}else continue}}s.refresh(true);t.getView().byId("btn2").setEnabled(true)},handleResetBtn:function(e){var t=this;var a="EnvTable";var o="Environment_Report";var s=this.getView().byId(a).getModel("EnvModel");var r=this.getView().byId(a).getSelectedItems();var l=this.KPITypeSelected;var n=this.KPISubtypeSelected;var i=this.getView().byId("KPI").getSelectedKey();var d=t.getView().byId("box1").getSelectedKey();var c=t.getView().byId("box0").getSelectedKey();for(var g=0;g<r.length;g++){var u=r[g].mAggregations.cells[0].mAggregations.items[0].mProperties.text;for(var h=0;h<s.getData().results.length;h++){if(l===s.getData().results[h].Type&&n===s.getData().results[h].SubType&&i===s.getData().results[h].KPI&&d===s.getData().results[h].Location&&c===s.getData().results[h].Division&&u===s.getData().results[h].Month){s.getData().results[h].isEditableRow=false;break}else continue}}s.refresh(true)},onUpdateEntry_Table1:function(){console.log("on submit");var e=this;var t=sap.ui.getCore().getModel("GlobalIndustryModel").getData().Industry;var a=""+t;var o=e.getView().byId("box2").getSelectedKey();var s=e.getView().byId("box1").getSelectedKey().toString();var r=this.KPISubtypeSelected+"";var l=this.KPITypeSelected+"";var n=this.getView().byId("KPI").getSelectedKey()+"";if(this.template==="Table RTG"){var i=this.getView().byId("EnvTable5")}else{var i=this.getView().byId("EnvTable")}var d=i.getSelectedItems();var c={items:[]};var g=parseInt(0);for(var u=0;u<d.length;u++){var h=this.monthArr.indexOf(d[u].getCells()[0].mAggregations.items[0].getText());var y=this.yearArr[h];console.log("monthArr yearL:"+h);console.log("monthArr yearR:"+y);var p=parseFloat(d[u].getCells()[1].getValue());if(this.template==="Table RTG"){var b="kl"}else{var b=d[u].getCells()[2].mAggregations.items[0].getValue()+""}var v=d[u].getCells()[0].mAggregations.items[0].getText()+"";console.log("oUnit:"+b);var m="/Environment_Report(Industry='"+t+"',Year='"+y+"',Month='"+v+"',Location='"+s+"',Type='"+l+"',SubType='"+r+"',KPI='"+n+"',Sno="+g+")";var I=encodeURI(m);e.batchModel.update(I,{Value:p,Unit:b},{method:"PUT",success:function(t){e.getView().byId("EnvTable").getModel("EnvModel").refresh(true)},error:function(e){}})}},onCreateEntry_Table2:function(e){console.log("on submit");var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.UserInputMonth;var r=this.UserInputCurrency;var l=this.getView().byId("KPI").getSelectedKey();var n=t.getView().byId("EnvTable2").getModel("EnvModel");var i=this.getOwnerComponent().getModel("dataModel");var d=this.Scope;var c="2023";var g="/catalog/";var u=new sap.ui.model.odata.ODataModel("/v2/catalog/",true);var h=[];var y=["January","February","March","April","May","June","July","August","September","October","November","December"];for(var p=0;p<n.getData().results.length;p++){if(n.getData().results[p].isNewRow){var b={Year:t.getView().byId("box2").getSelectedKey(),Location:t.getView().byId("box1").getSelectedKey(),Type:""+o,SubType:""+a,KPI:l,Value:parseFloat(n.getData().results[p].Value),Unit:n.getData().results[p].Unit,Cost:parseFloat(n.getData().results[p].Cost),Currency:n.getData().results[p].Currency,Class:n.getData().results[p].class,Quality:"OK",Comment:n.getData().results[p].Comment,Owner:n.getData().results[p].Owner,Approver:n.getData().results[p].Approver,Division:t.getView().byId("box0").getSelectedKey(),Sno:parseInt(n.getData().results[p].Sno),Date:n.getData().results[p].Date,Value2:null,Unit2:null,Distance:null,Weight:null,Scope:this.Scope,Associates:null,Logic:this.KPILogic,Measure:this.KPIMeasure,GRIStd:this.KPIGRIStd,SDG:this.KPISDG,RenNon:this.KPIRenNon,FValue:0,FValue1:0,Month:y[new Date(n.getData().results[p].Date).getMonth()]};h.push(u.createBatchOperation("Environment_Report","POST",b))}}u.addBatchChangeOperations(h);u.submitBatch();u.refresh();console.log("jsonSustain:"+b)},onUpdateEntry_Table2:function(e){console.log("on submit");var t=this;var a=t.getView().byId("box2").getSelectedKey();var o=t.getView().byId("box1").getSelectedKey().toString();var s=this.KPISubtypeSelected+"";var r=this.KPITypeSelected+"";var l=this.getView().byId("KPI").getSelectedKey()+"";var n=["January","February","March","April","May","June","July","August","September","October","November","December"];var i=this.getView().byId("EnvTable2");var d=i.getSelectedItems();var c={items:[]};for(var g=0;g<d.length;g++){var u=parseFloat(d[g].getCells()[2].getValue());var h=d[g].getCells()[3].mAggregations.items[1].getValue()+"";var y=parseInt(d[g].getCells()[0].getText());var p=n[new Date(d[g].getCells()[1].getValue()).getMonth()];var b="/Environment_Report(Month='"+p+"',Year='"+a+"',Sno="+y+",Location='"+o+"',Type='"+r+"',SubType='"+s+"',KPI='"+l+"')";var v=encodeURI(b);console.log(v);var v=encodeURI(b);t.batchModel.update(v,{Value:u,Unit:h},{method:"PUT",success:function(e){},error:function(e){}})}console.log("oSelectedItems:"+c.items)},onCreateEntry_Table3:function(e){console.log("on submit");var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.UserInputMonth;var r=this.UserInputCurrency;var l=this.getView().byId("KPI").getSelectedKey();var n=t.getView().byId("EnvTable3").getModel("EnvModel");var i=this.getOwnerComponent().getModel("dataModel");var d=this.Scope;var c="2023";var g="/catalog/";var u=this.getOwnerComponent().getModel("dataModel");var h=[];for(var y=0;y<n.getData().results.length;y++){if(n.getData().results[y].isNewRow){var p={Year:t.getView().byId("box2").getSelectedKey(),Location:t.getView().byId("box1").getSelectedKey(),Type:""+o,SubType:""+a,KPI:l,Distance:parseFloat(n.getData().results[y].Distance),Unit1:n.getData().results[y].Unit1,Weight:parseFloat(n.getData().results[y].Weight),Unit2:n.getData().results[y].Unit2,Cost:parseFloat(n.getData().results[y].Cost),Currency:n.getData().results[y].Currency,Transport:n.getData().results[y].Transport,Quality:"OK",Comment:n.getData().results[y].Comment,Owner:n.getData().results[y].Owner,Approver:n.getData().results[y].Approver,Division:t.getView().byId("box0").getSelectedKey(),Sno:parseInt(n.getData().results[y].Sno),Date:n.getData().results[y].Date,FValue:0};h.push(u.createBatchOperation("Environment_Report3","POST",p))}}u.addBatchChangeOperations(h);u.submitBatch();u.refresh();console.log("jsonSustain:"+p)},onUpdateEntry_Table3:function(e){console.log("on submit");var t=this;var a=t.getView().byId("box2").getSelectedKey();var o=t.getView().byId("box1").getSelectedKey().toString();var s=this.KPISubtypeSelected+"";var r=this.KPITypeSelected+"";var l=this.getView().byId("KPI").getSelectedKey()+"";var n=this.getView().byId("EnvTable3");var i=n.getSelectedItems();var d={items:[]};for(var c=0;c<i.length;c++){var g=parseFloat(i[c].getCells()[2].getValue());var u=i[c].getCells()[3].mAggregations.items[1].getValue()+"";var h=parseInt(i[c].getCells()[0].getText());var y="/Environment_Report3(Year='"+a+"',Sno="+h+",Location='"+o+"',Type='"+r+"',SubType='"+s+"',KPI='"+l+"')";var p=encodeURI(y);console.log(p);var p=encodeURI(y);t.batchModel.update(p,{Value:g,Unit:u},{method:"PUT",success:function(e){},error:function(e){}})}console.log("oSelectedItems:"+d.items)},onCreateEntry_Table4:function(e){console.log("on submit table4");var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.UserInputMonth;var r=this.UserInputCurrency;var l=this.getView().byId("KPI").getSelectedKey();var n=t.getView().byId("EnvTable4").getModel("EnvModel");var i=this.getOwnerComponent().getModel("dataModel");var d=this.Scope;for(var c=0;c<n.getData().results.length;c++){if(n.getData().results[c].isNewRow){var g={Year:t.getView().byId("box2").getSelectedKey(),Month:"May",Location:t.getView().byId("box1").getSelectedKey(),Type:""+o,SubType:""+a,KPI:l,Division:t.getView().byId("box0").getSelectedKey(),Site:n.getData().results[c].Site,ValueE:parseFloat(n.getData().results[c].ValueE),Unit:n.getData().results[c].Unit,Cost:parseFloat(n.getData().results[c].Cost),Currency:""+r,Quality:"OK",Comment:n.getData().results[c].Comment,Owner:n.getData().results[c].Owner,Approver:n.getData().results[c].Approver,ValueA:parseFloat(n.getData().results[c].ValueA),Unit2:n.getData().results[c].Unit2};console.log(g);t.batchChanges.push(t.batchModel.createBatchOperation("Environment_EUI_Ports","POST",g))}}t.batchModel.addBatchChangeOperations(t.batchChanges);t.batchModel.submitBatch();t.batchModel.refresh();console.log("jsonSustain:"+g)},onUpdateEntry_Table4:function(e){console.log("on submit");var t=this;var a=t.getView().byId("box2").getSelectedKey();var o=t.getView().byId("box1").getSelectedKey().toString();var s=this.KPISubtypeSelected+"";var r=this.KPITypeSelected+"";var l=this.getView().byId("KPI").getSelectedKey()+"";var n=this.getView().byId("EnvTable4");var i=n.getSelectedItems();var d={items:[]};var c=parseInt(0);for(var g=0;g<i.length;g++){var u=parseFloat(i[g].getCells()[1].getValue());var h=i[g].getCells()[2].mAggregations.items[0].getText()+"";var y="May";var p=i[g].getCells()[0].getValue()+"";var b="Environment_EUI_Ports(Site='"+p+"',Year='"+a+"',Month='"+y+"',Location='"+o+"',Type='"+r+"',SubType='"+s+"',KPI='"+l+"')";var v=encodeURI(b);t.batchChanges.push(t.batchModel.createBatchOperation(v,"PATCH",{ValueE:u,Unit:h}))}},onCreateEntry_Table5:function(e){console.log("on submit table5");var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s=this.UserInputMonth;var r=this.UserInputCurrency;var l=this.getView().byId("KPI").getSelectedKey();var n=t.getView().byId("EnvTable5").getModel("EnvModel");var i=this.Scope;for(var d=0;d<n.getData().results.length;d++){if(n.getData().results[d].isNewRow){var c={Year:t.getView().byId("box2").getSelectedKey(),Month:n.getData().results[d].Month,Location:t.getView().byId("box1").getSelectedKey(),Type:""+o,SubType:""+a,KPI:l,Division:t.getView().byId("box0").getSelectedKey(),Value:parseFloat(n.getData().results[d].Value),Cost:parseFloat(n.getData().results[d].Cost),Currency:""+r,Quality:"OK",Comment:n.getData().results[d].Comment,Owner:n.getData().results[d].Owner,Approver:n.getData().results[d].Approver};console.log(c);t.batchChanges.push(t.batchModel.createBatchOperation("/Environment_RTG_Ports","POST",c))}}console.log("jsonSustain:"+c)},onUpdateEntry_Table5:function(e){console.log("on submit");var t=this;var a=t.getView().byId("box2").getSelectedKey();var o=t.getView().byId("box1").getSelectedKey().toString();var s=this.KPISubtypeSelected+"";var r=this.KPITypeSelected+"";var l=this.getView().byId("KPI").getSelectedKey()+"";var n=this.getView().byId("EnvTable5");var i=n.getSelectedItems();var d={items:[]};var c=parseInt(0);for(var g=0;g<i.length;g++){var u=parseFloat(i[g].getCells()[1].getValue());var h=i[g].getCells()[0].mAggregations.items[0].getText()+"";var y="/Environment_Report(Year='"+a+"',Month='"+h+"',Location='"+o+"',Type='"+r+"',SubType='"+s+"',KPI='"+l+"')";var p=encodeURI(y);t.batchChanges.push(t.batchModel.createBatchOperation(p,"PATCH",{Value:u,Unit:"kl"}))}},onPressTemplateUpload:function(e){var t=this;var a=this.KPISubtypeSelected;var o=this.KPITypeSelected;var s="";if(t.getView().byId("box2").getSelectedKey().length===3){s=true}else{s=false}var r=[],l=0;for(var n=0;n<t.getView().getModel("dataExtractModel").getData().length;n++){r.push(t.getView().getModel("dataExtractModel").getData()[n].name)}console.log("supplierArr:"+r);for(var i=0;i<t.EnvModel.getData().results.length;i++){t.EnvModel.getData().results[i].supplier=r[0];l++;if(l==12){r.shift()}}console.log("EnvModel:"+t.EnvModel.getData().results);this.batchChanges=[];this.batchModel=this.getOwnerComponent().getModel("dataModel");this.batchModel.setUseBatch(true);var d=this.getOwnerComponent().getModel("dataModel");for(var c=0;c<t.EnvModel.getData().results.length;c++){if(t.EnvModel.getData().results[c].isNewRow){var g=this.monthArr.indexOf(t.EnvModel.getData().results[c].Month);var u=this.yearArr[g];console.log("monthArr:"+this.monthArr);console.log("monthArr yearL:"+g);console.log("monthArr yearR:"+u);var h="";if(o==="NETWORK TRAFFIC"){h=""}else{h=this.LogicE}var y={Year:u,Month:t.EnvModel.getData().results[c].Month,Location:t.getView().byId("box1").getSelectedKey(),Type:""+o,SubType:""+a,KPI:t.getView().byId("KPI").getSelectedKey(),Value:parseFloat(t.EnvModel.getData().results[c].Value),Unit:t.EnvModel.getData().results[c].Unit,Cost:parseFloat(t.EnvModel.getData().results[c].Cost),Currency:t.EnvModel.getData().results[c].Currency,Quality:"OK",Comment:t.EnvModel.getData().results[c].Comment,Owner:t.EnvModel.getData().results[c].Owner,Approver:t.EnvModel.getData().results[c].Approver,Division:t.getView().byId("box0").getSelectedKey(),Sno:0,Date:null,Value2:0,Unit2:"",Distance:null,Weight:null,Scope:this.Scope,Associates:null,Logic:this.KPILogic,Measure:this.KPIMeasure,GRIStd:this.KPIGRIStd,SDG:this.KPISDG,Class:this.KPIClass,RenNon:this.KPIRenNon,FiscalType:s,YearA:this.yearA,fiscal:t.getView().byId("box2").getSelectedKey(),isValidationRequired:true,StartDate:this.StartDate,EndDate:this.EndDate,Standard1:this.Standard1,LogicE:h,IUnit:"",IValue:0,FValue:0,FValue1:0};console.log("jsonSustain:"+y);var p=this.GlobalIndustryModel.getData().TransactionTable;var b="/"+p;d.create(b,y,null,function(){sap.m.MessageToast.show("The details submitted Successfully!!!")},function(){alert("Create failed")})}}},onExportExcelTemplate:function(e){var t=[];var a=this;for(var o=0;o<e.getParameter("files").length;o++){this._importTemplate(e.getParameter("files")&&e.getParameter("files")[o]);var s=e.getParameter("files")[o].name;s=s.slice(0,-5);t.push(s)}var r=t;var l={};var n=[];for(var o=0;o<r.length;o++){var i={};i.name=r[o];i.isEditableRow=false;i.isExistingRow=true;i.isNewRow=false;n.push(i)}l=n;console.log("aMainObjectArray:"+n);var d=this.getView();if(!this._pDialog){this._pDialog=sap.ui.core.Fragment.load({id:d.getId(),name:"com.techm.sustainabilityui.fragment.DataExtraction",controller:this}).then(function(e){d.addDependent(e);return e})}var c=new sap.ui.model.json.JSONModel;this._pDialog.then(function(e){c.setData(l);a.getView().setModel(c,"dataExtractModel");for(var t=0;t<a.getView().getModel("dataExtractModel").getData().length;t++){a.getView().getModel("dataExtractModel").getData()[t].isEditableRow=false;a.getView().getModel("dataExtractModel").getData()[t].isExistingRow=true;a.getView().getModel("dataExtractModel").getData()[t].isNewRow=false}sap.ui.getCore().setModel(c,"dataExtractModel");e.setModel(c);e.open()})},onCancelDialog:function(){this.byId("dataDialog").close()},onOKDialog:function(){var e=this.getView().byId("dataExtractTbl").getSelectedItems();var t=this;for(var a=0;a<e.length;a++){var o=e[a].mAggregations.cells[0].mAggregations.items[0].mProperties.text;for(var s=0;s<t.getView().byId("dataExtractTbl").getModel("dataExtractModel").getData().length;s++){if(o===t.getView().byId("dataExtractTbl").getModel("dataExtractModel").getData()[s].name){t.getView().byId("dataExtractTbl").getModel("dataExtractModel").getData()[s].isEditableRow=false;break}else continue}}t.getView().byId("dataExtractTbl").getModel("dataExtractModel").refresh(true)},onEditDialog:function(e){var t=this.getView().byId("dataExtractTbl").getSelectedItems();console.log("rowItems:"+t);var a=this;for(var o=0;o<t.length;o++){var s=t[o].mAggregations.cells[0].mAggregations.items[0].mProperties.text;for(var r=0;r<a.getView().byId("dataExtractTbl").getModel("dataExtractModel").getData().length;r++){if(s===a.getView().byId("dataExtractTbl").getModel("dataExtractModel").getData()[r].name){a.getView().byId("dataExtractTbl").getModel("dataExtractModel").getData()[r].isEditableRow=true;break}else continue}}a.getView().byId("dataExtractTbl").getModel("dataExtractModel").refresh(true)},formatEditField:function(e,t,a){if(e||t){return true}else if(a){return false}},formatDisplayField:function(e,t,a){if(e||t){return false}else if(a){return true}},_importTemplate:function(e){this.flag="template";var t=this;var a={};if(e&&window.FileReader){var o=new FileReader;o.onload=function(e){var o=e.target.result;var s=XLSX.read(o,{type:"binary"});s.SheetNames.forEach(function(e){a=XLSX.utils.sheet_to_row_object_array(s.Sheets[e])});var r=a.length;for(var l=0;l<r;l++){a[l].isExistingRow=false;a[l].isNewRow=true;console.log("Measure:"+t.KPIMeasure);var n=a[l].Unit;var i=t.getView().getModel("measureValidationModel").getData().results.length;var d=t.KPIMeasure;for(var c=0;c<i;c++){if(t.getView().getModel("measureValidationModel").getData().results[c].MeasureType===d&&t.getView().getModel("measureValidationModel").getData().results[c].InputUom===n){a[l].Unit=t.getView().getModel("measureValidationModel").getData().results[c].OutputUoM}}}var g=[];var u=t.EnvModel.getData().results;u.push(...a);t.EnvModel.setData({results:u});t.EnvModel.refresh(true)};o.onerror=function(e){console.log(e)};o.readAsBinaryString(e)}},calloData_MeasureValidation:function(e){var a=this;var o=a.getOwnerComponent().getModel("dataModel");var s=a.KPIMeasure;var e=e;console.log("InputUOM:"+e);var r=new sap.ui.model.Filter({filters:[new sap.ui.model.Filter({path:"MeasureType",operator:sap.ui.model.FilterOperator.EQ,value1:s}),new sap.ui.model.Filter({path:"InputUom",operator:sap.ui.model.FilterOperator.EQ,value1:e})],and:true});a.OData.read("/Measure_Validation",{filters:[r],success:function(e,t){var o=new sap.ui.model.json.JSONModel;o.setData(e);a.getView().setModel(o,"measureValidationModel");a.OutputUoM=e.results[0].OutputUoM;console.log("OutputUoM:"+a.OutputUoM)},error:function(e){t.error("Error")}})},calloData_MeasureValidation1:function(){var e=this;var a=e.getOwnerComponent().getModel("dataModel");e.OData.read("/Measure_Validation",{success:function(t,a){var o=new sap.ui.model.json.JSONModel;o.setData(t);e.getView().setModel(o,"measureValidationModel");console.log("Output length:"+t.results.length)},error:function(e){t.error("Error")}})},onFileChange:function(e){var t=this;var a=e.getSource().getParent().getParent().getBindingContextPath().substr(9,length);console.log("idx onFileChange:"+a);var o=e.getParameters("files").files[0];this.file=o;console.log("file:"+this.file);var s=this.byId("fileUpload1");var r=new FileReader;r.onload=function(e){this.content=e.currentTarget.result;this.createfile(a)}.bind(this);r.readAsDataURL(this.file);console.log("file1:"+this.file)},createfile:function(e){var a=this;var o={content:this.content,mediaType:this.file.type,fileName:this.file.name};var s=new sap.ui.model.json.JSONModel;var r=new sap.ui.model.odata.v2.ODataModel("/v2/catalog",true);var l="/MediaFile";r.create(l,o,{success:function(o,r){var l=o.id;a.link=o.url;a.attachFile.push(o.url);s.setData(a.link);a.getView().setModel(s,"fileUploadModel");a.FileArr.push(a.link);var n="File Uploaded Successfully with URL: "+a.link;t.success(n);a.getView().byId("EnvTable").getModel("EnvModel").getData().results[e].url=a.link},error:function(e,t){}})},handleDownloadFile:function(e){var t=e.getSource().getParent().getParent().getBindingContextPath().substr(9,length);console.log("idx:"+t);var a=this.getView().byId("EnvTable").getModel("EnvModel").getData().results[t].url;console.log("url:"+a);if(a===null||a===""){sap.m.MessageToast.show("File not exists")}else{var o=a.substr(8,64);console.log("url:"+o);window.open("/v2/catalog"+o)}}})});var that;function getExtractionResults(e,t){var a=new sap.m.BusyDialog({title:"Extracting Results",text:"Extraction is in progress.. Please wait"});a.open();var o=e;var s=t;var r={results:[]};var l="/comtechmsustainabilityui/DocExtractor"+"/document-information-extraction/v1/document/jobs/"+e+"?returnNullValues=true&extractedValues=true";jQuery.ajax({url:l,method:"GET",headers:{Accept:"application/json",Authorization:t},success:function(e,t,l){if(e.status=="DONE"){a.close();sap.m.MessageToast.show("Data Extracted Successfully");console.log("------ Doc EXTRACTION DONE --------");console.log(e);var n={};for(var i=0;i<e.extraction.headerFields.length;i++){n[e.extraction.headerFields[i].name]=e.extraction.headerFields[i].value}for(var d=0;d<e.extraction.lineItems.length;d++){var c={};for(var g=0;g<e.extraction.lineItems[d].length;g++){c[e.extraction.lineItems[d][g].name]=e.extraction.lineItems[d][g].value}c.Year=n.Year;c.Location=n.Location;c.Division=n.Division;c.isExistingRow=false;c.isNewRow=true;r.results.push(c)}var u=that.getView().byId("EnvTable").getModel("EnvModel").getProperty("/results");var h=u.concat(r.results);that.getView().byId("EnvTable").getModel("EnvModel").getData().results=h;that.getView().byId("EnvTable").getModel("EnvModel").refresh(true);return}else if(e.status=="PENDING"){setTimeout(function(){console.log("Pending");getExtractionResults(o,s)},5e3)}else if(e.status=="FAILED"){var e={status:"DONE",id:"ab49626b-bffb-4669-a017-d906b3560b1a",fileName:"Energy_Report_V2_JantoJun_2022_IndirectEnergy_GridE.pdf",documentType:"custom",created:"2022-09-13T18:55:25.050171+00:00",finished:"2022-09-13T18:55:33.159633+00:00",templateId:"74e63a34-15fd-462c-a42a-8a58c30defbe",languageCodes:["en"],pageCount:1,schemaId:"c5c7e09b-4489-47e6-810d-4d78e19edd34",country:null,extraction:{headerFields:[{name:"Phone",category:"custom",value:"442045770088.00",rawValue:"442045770088.00",type:"number",page:1,confidence:1,coordinates:{x:.16862745098039217,y:.44319903059678883,w:.10549019607843137,h:.009088155104513784},label:"Phone"},{name:"Location",category:"custom",value:"Nashville",rawValue:"Nashville",type:"string",page:1,confidence:1,coordinates:{x:.1843137254901961,y:.4580430172674947,w:.05764705882352941,h:.00969403211148137},label:"Location"},{name:"Name",category:"custom",value:"Henry Lucas",rawValue:"Henry Lucas",type:"string",page:1,confidence:1,coordinates:{x:.11803921568627451,y:.4274462284156316,w:.07882352941176471,h:.011814601635867894},label:"Name"},{name:"Year",category:"custom",value:"2022",rawValue:"2022",type:"string",page:1,confidence:1,coordinates:{x:.15725490196078432,y:.5207512874886399,w:.03176470588235294,h:.009088155104513784},label:"Year"},{name:"Division",category:"custom",value:"ACME Industries",rawValue:"ACME Industries",type:"string",page:1,confidence:1,coordinates:{x:.183921568627451,y:.4737958194486519,w:.10901960784313722,h:.009996970614965184},label:"Division"},{name:"Date",category:"custom",value:"2022-09-14",rawValue:"2022-09-14",type:"date",page:1,confidence:1,coordinates:{x:.1588235294117647,y:.5362011511663133,w:.06431372549019608,h:.008482278097546198},label:"Date"}],lineItems:[[{name:"Comment",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:1,coordinates:{x:.9070588235294118,y:.6004241139048773,w:.019215686274509758,h:.008482278097546203},label:"Comment"},{name:"Cost",category:"custom",value:"28990.00",rawValue:"28990.00",type:"number",page:1,confidence:.9950000000000003,coordinates:{x:.6113725490196078,y:.6001211754013935,w:.0388235294117647,h:.009391093607997614},label:"Cost"},{name:"Currency",category:"custom",value:"USD",rawValue:"USD",type:"currency",page:1,confidence:1,coordinates:{x:.6819607843137255,y:.6001211754013935,w:.025882352941176467,h:.009391093607997614},label:"Currency"},{name:"Month",category:"custom",value:"January",rawValue:"January",type:"string",page:1,confidence:.9285714285714284,coordinates:{x:.3968627450980392,y:.5998182368979097,w:.051764705882352935,h:.012420478642835464},label:"Month"},{name:"Quality",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:1,coordinates:{x:.8003921568627451,y:.6004241139048773,w:.018039215686274535,h:.008482278097546203},label:"Quality"},{name:"SubType",category:"custom",value:"Grid Electricity(Non-RE)",rawValue:"Grid Electricity(Non-RE)",type:"string",page:1,confidence:1,coordinates:{x:.2192156862745098,y:.5992123598909421,w:.15411764705882355,h:.012420478642835464},label:"SubType"},{name:"Type",category:"custom",value:"Indirect Energy",rawValue:"Indirect Energy",type:"string",page:1,confidence:.9980392156862745,coordinates:{x:.09686274509803922,y:.5989094213874584,w:.0996078431372549,h:.012420478642835464},label:"Type"},{name:"Unit",category:"custom",value:"kWh",rawValue:"kWh",type:"string",page:1,confidence:1,coordinates:{x:.5505882352941176,y:.6001211754013935,w:.02784313725490195,h:.009391093607997614},label:"Unit"},{name:"Value",category:"custom",value:"143950.00",rawValue:"143950.00",type:"number",page:1,confidence:1,coordinates:{x:.4764705882352941,y:.6001211754013935,w:.04705882352941171,h:.009391093607997614},label:"Value"}],[{name:"Comment",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:1,coordinates:{x:.9070588235294118,y:.6167827930930021,w:.019215686274509758,h:.009391093607997614},label:"Comment"},{name:"Cost",category:"custom",value:"25983.00",rawValue:"25983.00",type:"number",page:1,confidence:1,coordinates:{x:.6113725490196078,y:.6164798545895184,w:.039215686274509776,h:.009088155104513773},label:"Cost"},{name:"Currency",category:"custom",value:"USD",rawValue:"USD",type:"currency",page:1,confidence:1,coordinates:{x:.6819607843137255,y:.6164798545895184,w:.025882352941176467,h:.009088155104513773},label:"Currency"},{name:"Month",category:"custom",value:"February",rawValue:"February",type:"string",page:1,confidence:.9772727272727273,coordinates:{x:.3996078431372549,y:.6164798545895184,w:.05764705882352944,h:.011511663132384164},label:"Month"},{name:"Quality",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:1,coordinates:{x:.8003921568627451,y:.6167827930930021,w:.018039215686274535,h:.009391093607997614},label:"Quality"},{name:"SubType",category:"custom",value:"Grid Electricity(Non-RE)",rawValue:"Grid Electricity(Non-RE)",type:"string",page:1,confidence:.9999999999999998,coordinates:{x:.2192156862745098,y:.6164798545895184,w:.1541176470588235,h:.011511663132384164},label:"SubType"},{name:"Type",category:"custom",value:"Indirect Energy",rawValue:"Indirect Energy",type:"string",page:1,confidence:1,coordinates:{x:.09647058823529411,y:.6164798545895184,w:.1,h:.011511663132384164},label:"Type"},{name:"Unit",category:"custom",value:"kWh",rawValue:"kWh",type:"string",page:1,confidence:1,coordinates:{x:.5505882352941176,y:.6164798545895184,w:.02784313725490195,h:.009391093607997614},label:"Unit"},{name:"Value",category:"custom",value:"111550.00",rawValue:"111550.00",type:"number",page:1,confidence:1,coordinates:{x:.4764705882352941,y:.6164798545895184,w:.04705882352941171,h:.011511663132384164},label:"Value"}],[{name:"Comment",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:1,coordinates:{x:.9070588235294118,y:.6325355952741594,w:.019215686274509758,h:.009694032111481343},label:"Comment"},{name:"Cost",category:"custom",value:"14905.00",rawValue:"14905.00",type:"number",page:1,confidence:.9798979591836747,coordinates:{x:.6109803921568627,y:.6322326567706755,w:.03843137254901963,h:.010602847621932754},label:"Cost"},{name:"Currency",category:"custom",value:"USD",rawValue:"USD",type:"currency",page:1,confidence:.9925373134328362,coordinates:{x:.6819607843137255,y:.6322326567706755,w:.026274509803921542,h:.010299909118448913},label:"Currency"},{name:"Month",category:"custom",value:"March",rawValue:"March",type:"string",page:1,confidence:.8441558441558439,coordinates:{x:.3992156862745098,y:.6322326567706755,w:.04156862745098039,h:.011814601635867894},label:"Month"},{name:"Quality",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:.9791666666666679,coordinates:{x:.8003921568627451,y:.6328385337776431,w:.018823529411764683,h:.009694032111481343},label:"Quality"},{name:"SubType",category:"custom",value:"Grid Electricity(Non-RE)",rawValue:"Grid Electricity(Non-RE)",type:"string",page:1,confidence:1,coordinates:{x:.2192156862745098,y:.6322326567706755,w:.15411764705882355,h:.011511663132384164},label:"SubType"},{name:"Type",category:"custom",value:"Indirect Energy",rawValue:"Indirect Energy",type:"string",page:1,confidence:.9980392156862746,coordinates:{x:.09647058823529411,y:.6319297182671918,w:.09960784313725493,h:.011814601635867894},label:"Type"},{name:"Unit",category:"custom",value:"kWh",rawValue:"kWh",type:"string",page:1,confidence:.993055555555556,coordinates:{x:.5501960784313725,y:.6322326567706755,w:.028235294117647025,h:.010602847621932754},label:"Unit"},{name:"Value",category:"custom",value:"65260.00",rawValue:"65260.00",type:"number",page:1,confidence:.9075000000000006,coordinates:{x:.476078431372549,y:.6325355952741594,w:.039215686274509776,h:.010299909118448913},label:"Value"}],[{name:"Comment",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:.9803921568627435,coordinates:{x:.9070588235294118,y:.6491972129657679,w:.020000000000000018,h:.008482278097546203},"label ":"Comment"},{name:"Cost",category:"custom",value:"30407.00",rawValue:"30407.00",type:"number",page:1,confidence:.9950495049504953,coordinates:{x:.6113725490196078,y:.6482883974553165,w:.03960784313725485,h:.009996970614965184},label:"Cost"},{name:"Currency",category:"custom",value:"USD",rawValue:"USD",type:"currency",page:1,confidence:.9848484848484858,coordinates:{x:.6823529411764706,y:.6482883974553165,w:.025882352941176467,h:.009996970614965184},label:"Currency"},{name:"Month",category:"custom",value:"April",rawValue:"April",type:"string",page:1,confidence:.7564935064935066,coordinates:{x:.3984313725490196,y:.6485913359588004,w:.030980392156862768,h:.012117540139351735},label:"Month"},{name:"Quality",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:.9791666666666679,coordinates:{x:.8003921568627451,y:.6491972129657679,w:.018823529411764683,h:.008482278097546203},label:"Quality"},{name:"SubType",category:"custom",value:"Grid Electricity(Non-RE)",rawValue:"Grid Electricity(Non-RE)",type:"string",page:1,confidence:.9974683544303797,coordinates:{x:.2188235294117647,y:.6482883974553165,w:.15490196078431373,h:.012117540139351735},label:"SubType"},{name:"Type",category:"custom",value:"Indirect Energy",rawValue:"Indirect Energy",type:"string",page:1,confidence:1,coordinates:{x:.09647058823529411,y:.6479854589518328,w:.1,h:.012117540139351735},label:"Type"},{name:"Unit",category:"custom",value:"kWh",rawValue:"kWh",type:"string",page:1,confidence:.9929577464788737,coordinates:{x:.5505882352941176,y:.6485913359588004,w:.027450980392156876,h:.009996970614965184},label:"Unit"},{name:"Value",category:"custom",value:"130920.00",rawValue:"130920.00",type:"number",page:1,confidence:.9918032786885239,coordinates:{x:.476078431372549,y:.6485913359588004,w:.04784313725490197,h:.009996970614965184},label:"Value"}],[{name:"Comment",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:.9803921568627435,coordinates:{x:.9070588235294118,y:.6655558921538928,w:.020000000000000018,h:.008482278097546203},label:"Comment"},{name:"Cost",category:"custom",value:"19708.00",rawValue:"19708.00",type:"number",page:1,confidence:.9850000000000009,coordinates:{x:.6121568627450981,y:.6649500151469252,w:.03803921568627455,h:.009391093607997614},label:"Cost"},{name:"Currency",category:"custom",value:"USD",rawValue:"USD",type:"currency",page:1,confidence:.9924242424242429,coordinates:{x:.6823529411764706,y:.6649500151469252,w:.025490196078431393,h:.009391093607997614},label:"Currency"},{name:"Month",category:"custom",value:"May",rawValue:"May",type:"string",page:1,confidence:.7337662337662338,coordinates:{x:.3992156862745098,y:.6646470766434414,w:.02823529411764708,h:.011814601635867894},label:"Month"},{name:"Quality",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:1,coordinates:{x:.8003921568627451,y:.6655558921538928,w:.018039215686274535,h:.008482278097546203},label:"Quality"},{name:"SubType",category:"custom",value:"Grid Electricity(Non-RE)",rawValue:"Grid Electricity(Non-RE)",type:"string",page:1,confidence:.9974554707379135,coordinates:{x:.2196078431372549,y:.6643441381399576,w:.15411764705882353,h:.011814601635867894},label:"SubType"},{name:"Type",category:"custom",value:"Indirect Energy",rawValue:"Indirect Energy",type:"string",page:1,confidence:1,coordinates:{x:.09647058823529411,y:.6640411996364738,w:.1,h:.011814601635867894},label:"Type"},{name:"Unit",category:"custom",value:"kWh",rawValue:"kWh",type:"string",page:1,confidence:.993055555555556,coordinates:{x:.5501960784313725,y:.6649500151469252,w:.028235294117647025,h:.009088155104513773},label:"Unit"},{name:"Value",category:"custom",value:"84589.00",rawValue:"84589.00",type:"number",page:1,confidence:.8990646258503414,coordinates:{x:.476078431372549,y:.6649500151469252,w:.03843137254901963,h:.009088155104513773},label:"Value"}],[{name:"Comment",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:.9795918367346951,coordinates:{x:.9070588235294118,y:.6807028173280824,w:.01843137254901961,h:.009996970614965184},label:"Comment"},{name:"Cost",category:"custom",value:"18500.00",rawValue:"18500.00",type:"number",page:1,confidence:.9950495049504953,coordinates:{x:.6109803921568627,y:.6807028173280824,w:.03960784313725485,h:.009996970614965184},label:"Cost"},{name:"Currency",category:"custom",value:"USD",rawValue:"USD",type:"currency",page:1,confidence:1,coordinates:{x:.6819607843137255,y:.6807028173280824,w:.025882352941176467,h:.009996970614965184},label:"Currency"},{name:"Month",category:"custom",value:"June",rawValue:"June",type:"string",page:1,confidence:.7629870129870127,coordinates:{x:.3968627450980392,y:.6807028173280824,w:.03176470588235292,h:.011208724628900324},label:"Month"},{name:"Quality",category:"custom",value:"OK",rawValue:"OK",type:"string",page:1,confidence:.9599999999999997,coordinates:{x:.7996078431372549,y:.6807028173280824,w:.019607843137254943,h:.009996970614965184},label:"Quality"},{name:"SubType",category:"custom",value:"Grid Electricity(Non-RE)",rawValue:"Grid Electricity(Non-RE)",type:"string",page:1,confidence:.9974683544303797,coordinates:{x:.2188235294117647,y:.6807028173280824,w:.15490196078431373,h:.011208724628900324},label:"SubType"},{name:"Type",category:"custom",value:"Indirect Energy",rawValue:"Indirect Energy",type:"string",page:1,confidence:1,coordinates:{x:.09647058823529411,y:.6807028173280824,w:.1,h:.011208724628900324},label:"Type"},{name:"Unit",category:"custom",value:"kWh",rawValue:"kWh",type:"string",page:1,confidence:.993055555555556,coordinates:{x:.5501960784313725,y:.6807028173280824,w:.028235294117647025,h:.009996970614965184},label:"Unit"},{name:"Value",category:"custom",value:"78466.00",rawValue:"78466.00",type:"number",page:1,confidence:.9025990099009911,coordinates:{x:.47568627450980394,y:.6807028173280824,w:.03960784313725485,h:.009996970614965184},label:"Value"}]]},bocrVersion:"2.5.0",doxVersion:"1.60.3",fileType:"pdf",dataForRetrainingStatus:"notUsedForTraining"};var n={};for(var i=0;i<e.extraction.headerFields.length;i++){n[e.extraction.headerFields[i].name]=e.extraction.headerFields[i].value}for(var d=0;d<e.extraction.lineItems.length;d++){var c={};for(var g=0;g<e.extraction.lineItems[d].length;g++){c[e.extraction.lineItems[d][g].name]=e.extraction.lineItems[d][g].value}c.Year=n.Year;c.Location=n.Location;c.Division=n.Division;c.isExistingRow=false;c.isNewRow=true;r.results.push(c)}var u=that.getView().byId("EnvTable").getModel("EnvModel").getProperty("/results");var h=u.concat(r.results);that.getView().byId("EnvTable").getModel("EnvModel").getData().results=h;that.getView().byId("EnvTable").getModel("EnvModel").refresh(true)}},error:function(e,t,a){sap.m.MessageToast.show("Error in fetching extraction results: "+a)},complete:function(e,t){a.close();console.log("xhr: "+e);console.log("Status: "+t)}})}
//# sourceMappingURL=Environment.controller.js.map